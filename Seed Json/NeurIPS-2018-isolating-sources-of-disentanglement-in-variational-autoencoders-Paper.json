{
  "pdf": "NeurIPS-2018-isolating-sources-of-disentanglement-in-variational-autoencoders-Paper",
  "title": "Isolating Sources of Disentanglement in Variational Autoencoders",
  "author": "Tian Qi Chen, Xuechen Li, Roger B. Grosse, David K. Duvenaud",
  "paper_id": "NeurIPS-2018-isolating-sources-of-disentanglement-in-variational-autoencoders-Paper",
  "text": "Isolating Sources of Disentanglement in V AEs\nRicky T. Q. Chen, Xuechen Li, Roger Grosse, David Duvenaud\nUniversity of Toronto, V ector Institute\n��������� ��������� �������� �����������������������\nAbstract\nWe decompose the evidence lower bound to show the existence of a term measuring\nthe total correlation between latent variables. We use this to motivate the β-TCV AE\n(Total Correlation V ariational Autoencoder) algorithm, a reﬁnement and plug-in\nreplacement of the β-V AE for learning disentangled representations, requiring\nno additional hyperparameters during training. We further propose a principled\nclassiﬁer-free measure of disentanglement called the mutual information gap (MIG).\nWe perform extensive quantitative and qualitative experiments, in both restricted\nand non-restricted settings, and show a strong relation between total correlation\nand disentanglement, when the model is trained using our framework.\n1 Introduction\nLearning disentangled representations without supervision is a difﬁcult open problem. Disentangled\nvariables are generally considered to contain interpretable semantic information and reﬂect separate\nfactors of variation in the data. While the deﬁnition of disentanglement is open to debate, many\nbelieve a factorial representation, one with statistically independent variables, is a good starting\npoint [1, 2, 3]. Such representations distill information into a compact form which is oftentimes\nsemantically meaningful and useful for a variety of tasks [ 2, 4]. For instance, it is found that such\nrepresentations are more generalizable and robust against adversarial attacks [ 5].\nMany state-of-the-art methods for learning disentangled representations are based on re-weighting\nparts of an existing objective. For instance, it is claimed that mutual information between latent\nvariables and the observed data can encourage the latents into becoming more interpretable [ 6]. It\nis also argued that encouraging independence between latent variables induces disentanglement\n[7]. However, there is no strong evidence linking factorial representations to disentanglement. In\npart, this can be attributed to weak qualitative evaluation procedures. While traversals in the latent\nrepresentation can qualitatively illustrate disentanglement, quantitative measures of disentanglement\nare in their infancy.\nIn this paper, we:\n• show a decomposition of the variational lower bound that can be used to explain the success\nof theβ-V AE [7] in learning disentangled representations.\n• propose a simple method based on weighted minibatches to stochastically train with arbitrary\nweights on the terms of our decomposition without any additional hyperparameters.\n• introduce the β-TCV AE, which can be used as a plug-in replacement for the β-V AE with no\nextra hyperparameters. Empirical evaluations suggest that the β-TCV AE discovers more\ninterpretable representations than existing methods, while also being fairly robust to random\ninitialization.\n• propose a new information-theoretic disentanglement metric, which is classiﬁer-free and\ngeneralizable to arbitrarily-distributed and non-scalar latent variables.\n32nd Conference on Neural Information Processing Systems (NeurIPS 2018), Montréal, Canada.\nβ-V AE [7]\nβ-TCV AE (Our)\n(a) Baldness (-6, 6)\n (b) Face width (0, 6)\n (c) Gender (-6, 6)\n (d) Mustache (-6, 0)\nFigure 1: Qualitative comparisons on CelebA. Traversal ranges are shown in parentheses. Some\nattributes are only manifested in one direction of a latent variable, so we show a one-sided traversal.\nMost semantically similar variables from aβ-V AE are shown for comparison.\nWhile Kim & Mnih [ 8] have independently proposed augmenting V AEs with an equivalent total\ncorrelation penalty to the β-TCV AE, their proposed training method differs from ours and requires\nan auxiliary discriminator network.\n2 Background: Learning and Evaluating Disentangled Representations\nWe discuss existing work that aims at either learning disentangled representations without supervision\nor evaluating such representations. The two problems are inherently related, since improvements\nto learning algorithms require evaluation metrics that are sensitive to subtle details, and stronger\nevaluation metrics reveal deﬁciencies in existing methods.\n2.1 Learning Disentangled Representations\nV AE andβ-V AE The variational autoencoder (V AE) [9, 10] is a latent variable model that pairs a\ntop-down generator with a bottom-up inference network. Instead of directly performing maximum\nlikelihood estimation on the intractable marginal log-likelihood, training is done by optimizing the\ntractableevidence lower bound(ELBO). We would like to optimize this lower bound averaged over\nthe empirical distribution (withβ= 1):\nLβ = 1\nN\nN�\nn=1\n(Eq [logp(x n|z)]−βKL(q(z|x n)||p(z))) (1)\nThe β-V AE [7] is a variant of the variational autoencoder that attempts to learn a disentangled\nrepresentation by optimizing a heavily penalized objective with β > 1. Such simple penalization\nhas been shown to be capable of obtaining models with a high degree of disentanglement in image\ndatasets. However, it is not made explicit why penalizing KL(q(z|x)||p(z)) with a factorial prior can\nlead to learning latent variables that exhibit disentangled transformations for all data samples.\nInfoGAN The InfoGAN [ 6] is a variant of the generative adversarial network (GAN) [ 11] that\nencourages an interpretable latent representation by maximizing the mutual information between the\nobservation and a small subset of latent variables. The approach relies on optimizing a lower bound\nof the intractable mutual information.\n2.2 Evaluating Disentangled Representations\nWhen the true underlying generative factors are known and we have reason to believe that this\nset of factors is disentangled, it is possible to create a supervised evaluation metric. Many have\nproposed classiﬁer-based metrics for assessing the quality of disentanglement [ 7, 8, 12, 13, 14, 15].\n2\nWe focus on discussing the metrics proposed in [ 7] and [8], as they are relatively simple in design\nand generalizable.\nThe Higgins’ metric [ 7] is deﬁned as the accuracy that a low VC-dimension linear classiﬁer can\nachieve at identifying aﬁxed ground truth factor. Speciﬁcally, for a set of ground truth factors\n{vk}K\nk=1, each training data point is an aggregation over L samples: 1\nL\n� L\nl=1 |z(1)\nl −z (2)\nl |, where\nrandom vectors z(1)\nl , z(2)\nl are drawn i.i.d. from q(z|vk)1 for anyﬁxed value of vk, and a classiﬁcation\ntarget k. A drawback of this method is the lack of axis-alignment detection. That is, we believe a truly\ndisentangled model should only contain one latent variable that is related to each factor. As a means\nto include axis-alignment detection, [ 8] proposes using argminj V arq(zj |vk )[zj ] and a majority-vote\nclassiﬁer.\nClassiﬁer-based disentanglement metrics tend to bead-hocand sensitive to hyperparameters. The\nmetrics in [ 7] and [ 8] can be loosely interpreted as measuring the reduction in entropy of z if v\nis observed. In section 4, we show that it is possible to directly measure the mutual information\nbetween z and v which is a principled information-theoretic quantity that can be used for any latent\ndistributions provided that efﬁcient estimation exists.\n3 Sources of Disentanglement in the ELBO\nIt is suggested that two quantities are especially important in learning a disentangled representation\n[6, 7]: A) Mutual information between the latent variables and the data variable, and B) Independence\nbetween the latent variables.\nA term that quantiﬁes criterion A was illustrated by an ELBO decomposition [ 16]. In this section, we\nintroduce a reﬁned decomposition showing that terms describing both criteria appear in the ELBO.\nELBO TC-Decomposition We identify each training example with a unique integer index and\ndeﬁne a uniform random variable on {1,2, ..., N} with which we relate to data points. Fur-\nthermore, we deﬁne q(z|n) =q(z|x n) and q(z, n) =q(z|n)p(n) =q(z|n) 1\nN . We refer to\nq(z) = � N\nn=1 q(z|n)p(n)as theaggregated posteriorfollowing [ 17], which captures the aggregate\nstructure of the latent variables under the data distribution. With this notation, we decompose the KL\nterm in (1) assuming a factorizedp(z).\nEp(n)\n�\nKL\n�\nq(z|n)||p(z)\n��\n=KL(q(z, n)||q(z)p(n))� �� �\ni Index-Code MI\n+KL\n�\nq(z)||\n�\nj\nq(zj )\n�\n� �� �\nii Total Correlation\n+\n�\nj\nKL(q(z j )||p(zj ))\n� �� �\niii Dimension-wise KL\n(2)\nwherez j denotes thejth dimension of the latent variable.\nDecomposition Analysis In a similar decomposition [ 16], i is referred to as theindex-code\nmutual information(MI). The index-code MI is the mutual information Iq (z;n) between the data\nvariable and latent variable based on the empirical data distribution q(z, n). It is argued that a\nhigher mutual information can lead to better disentanglement [ 6], and some have even proposed to\ncompletely drop the penalty on this term during optimization [ 17, 18]. However, recent investigations\ninto generative modeling also claim that a penalized mutual information through the information\nbottleneck encourages compact and disentangled representations [ 3, 19].\nIn information theory, ii is referred to as thetotal correlation(TC), one of many generalizations\nof mutual information to more than two random variables [ 20]. The naming is unfortunate as it is\nactually a measure of dependence between the variables. The penalty on TC forces the model toﬁnd\nstatistically independent factors in the data distribution. We claim that a heavier penalty on this term\ninduces a more disentangled representation, and that the existence of this term is the reason β-V AE\nhas been successful.\n1Note thatq(z|v k )is sampled by using an intermediate data sample:z∼q(z|x), x∼p(x|v k ).\n3\nWe refer to iii as thedimension-wiseKL. This term mainly prevents individual latent dimensions\nfrom deviating too far from their corresponding priors. It acts as a complexity penalty on the aggregate\nposterior which reasonably follows from the minimum description length [ 21] formulation of the\nELBO.\nWe would like to verify the claim that TC is the most important term in this decomposition for\nlearning disentangled representations by penalizing only this term; however, it is difﬁcult to estimate\nthe three terms in the decomposition. In the following section, we propose a simple yet general\nframework for training with the TC-decomposition using minibatches of data.\nA special case of this decomposition was given in [ 22], assuming that the use of aﬂexible prior can\neffectively ignore the dimension-wise KL term. In contrast, our decomposition (2) is more generally\napplicable to many applications of the ELBO.\n3.1 Training with Minibatch-Weighted Sampling\nWe describe a method to stochastically estimate the decomposition terms, allowing scalable training\nwith arbitrary weights on each decomposition term. Note that the decomposed expression (2) requires\nthe evaluation of the density q(z) =E p(n)[q(z|n)], which depends on the entire dataset 2. As such, it\nis undesirable to compute it exactly during training. One main advantage of our stochastic estimation\nmethod is the lack of hyperparameters or inner optimization loops, which should provide more stable\ntraining.\nA naïve Monte Carlo approximation based on a minibatch of samples from p(n) is likely to underes-\ntimate q(z). This can be intuitively seen by viewing q(z) as a mixture distribution where the data\nindex n indicates the mixture component. With a randomly sampled component, q(z|n) is close to 0,\nwhereas q(z|n) would be large if n is the component that z came from. So it is much better to sample\nthis component and weight the probability appropriately.\nTo this end, we propose using a weighted version for estimating the function logq(z) during training,\ninspired by importance sampling. When provided with a minibatch of samples {n1, ..., nM }, we can\nuse the estimator\nEq(z) [logq(z)]≈ 1\nM\nM�\ni=1\n\nlog 1\nN M\nM�\nj=1\nq(z(ni)|nj )\n\n (3)\nwhere z(ni) is a sample from q(z|ni) (see derivation in Appendix C). This minibatch estimator is\nbiased, since its expectation is a lower bound 3. However, computing it does not require any additional\nhyperparameters.\n3.1.1 Special case:β-TCV AE\nWith minibatch-weighted sampling, it is easy to assign different weights ( α,β,γ ) to the terms in (2):\nLβ−TC :=E q(z|n)p(n) [logp(n|z)]−αI q (z;n)−βKL\n�\nq(z)||\n�\nj\nq(zj )\n�\n−γ\n�\nj\nKL(q(z j )||p(zj ))\n(4)\nWhile we performed ablation experiments with different values for α and γ, we ultimatelyﬁnd that\ntuning β leads to the best results. Our proposed β-TCV AE usesα=γ= 1 and only modiﬁes the\nhyperparameter β. While Kim & Mnih [ 8] have proposed an equivalent objective, they estimate TC\nusing an auxiliary discriminator network.\n4 Measuring Disentanglement with the Mutual Information Gap\nIt is difﬁcult to compare disentangling algorithms without a proper metric. Most prior work has\nresorted to qualitative analysis by visualizing the latent representation. Another approach relies\non knowing the true generative process p(n|v) and ground truth latent factors v. Often these are\n2The same argument holds for the term �\nj q(zj )and a similar estimator can be constructed.\n3This follows from Jensen’s inequalityE p(n)[logq(z|n)]≤logE p(n)[q(z|n)].\n4\nsemantically meaningful attributes of the data. For instance, photographic portraits generally contain\ndisentangled factors such as pose (azimuth and elevation), lighting condition, and attributes of the\nface such as skin tone, gender, face width, etc. Though not all ground truth factors may be provided,\nit is still possible to evaluate disentanglement using the known factors. We propose a metric based on\nthe empirical mutual information between latent variables and ground truth factors.\n4.1 Mutual Information Gap (MIG)\nOur key insight is that theempirical mutual informationbetween a latent variable zj and a\nground truth factor vk can be estimated using the joint distribution deﬁned by q(zj , vk) =� N\nn=1 p(vk)p(n|vk)q(zj |n). Assuming that the underlying factors p(vk) and the generating process\nis known for the empirical data samplesp(n|v k), then\nIn(zj ;v k) =E q(zj ,vk )\n\nlog\n�\nn∈Xvk\nq(zj |n)p(n|vk)\n\n +H(z j ) (5)\nwhereX vk is the support ofp(n|v k). (See derivation in Appendix B.)\nA higher mutual information implies that zj contains a lot of information about vk, and the mutual\ninformation is maximal if there exists a deterministic, invertible relationship between zj and vj .\nFurthermore, for discrete vk, 0≤I(z j ;v k)≤H(v k), where H(vk) =E p(vk )[−logp(v k)] is the\nentropy ofv k. As such, we use the normalized mutual informationI(z j ;v k)/H(vk).\nNote that a single factor can have high mutual information with multiple latent variables. We enforce\naxis-alignment by measuring the difference between the top two latent variables with highest mutual\ninformation. The full metric we callmutual information gap(MIG) is then\n1\nK\nK�\nk=1\n1\nH(vk)\n�\nIn(zj(k) ;v k)−max\nj�=j (k)\nIn(zj ;v k)\n�\n(6)\nwhere j(k) =argmax j In(zj ;v k) and K is the number of known factors. MIG is bounded by 0 and 1.\nWe perform an entire pass through the dataset to estimate MIG.\nWhile it is possible to compute just the average maximal MI, 1\nK\n� K\nk=1\nIn (zk∗ ;vk )\nH(vk ) , the gap in our\nformulation (6) defends against two important cases. Theﬁrst case is related to rotation of the factors.\nWhen a set of latent variables are not axis-aligned, each variable can contain a decent amount of\ninformation regarding two or more factors. The gap heavily penalizes unaligned variables, which is\nan indication of entanglement. The second case is related to compactness of the representation. If one\nlatent variable reliably models a ground truth factor, then it is unnecessary for other latent variables\nto also be informative about this factor.\nMetric Axis Unbiased General\nHigginset al.[ 7] No No No\nKim & Mnih [ 8] Y es No No\nMIG (Ours) Y es Y es Y es\nTable 1: In comparison to prior metrics, our proposed\nMIG detects axis-alignment, is unbiased for all hyper-\nparameter settings, and can be generally applied to any\nlatent distributions provided efﬁcient estimation exists.\nAs summarized in Table 1, our metric de-\ntects axis-alignment and is generally appli-\ncable and meaningful for any factorized la-\ntent distribution, including vectors of mul-\ntimodal, categorical, and other structured\ndistributions. This is because the metric is\nonly limited by whether the mutual informa-\ntion can be estimated. Efﬁcient estimation of\nmutual information is an ongoing research\ntopic [ 23, 24], but weﬁnd that the simple\nestimator (5) can be computed within rea-\nsonable amount of time for the datasets we\nuse. Weﬁnd that MIG can better capture\nsubtle differences in models compared to existing metrics. Systematic experiments analyzing MIG\nand existing metrics are in Appendix G.\n5 Related Work\nWe focus on discussing the learning of disentangled representations in an unsupervised manner.\nNevertheless, we note that inverting generative processes with known disentangled factors through\n5\nweak supervision has been pursued by many. The goal in this case is not perfect inversion but to\ndistill simpler representation [ 15, 25, 26, 27, 28]. Although not explicitly the main motivation, many\nunsupervised generative modeling frameworks have explored the disentanglement of their learned\nrepresentations [9, 17, 29]. Prior to β-V AE [7], some have shown successful disentanglement in\nlimited settings with few factors of variation [ 1, 14, 30, 31].\nAs a means to describe the properties of disentangled representations, factorial representations have\nbeen motivated by many [1, 2, 3, 22, 32, 33]. In particular, Appendix B of [ 22] shows the existence of\nthe total correlation in a similar objective with aﬂexible prior and assuming optimality q(z) =p(z) .\nSimilarly, [34] arrives at the ELBO from an objective that combines informativeness and the total\ncorrelation of latent variables. In contrast, we show a more general analysis of the unmodiﬁed\nevidence lower bound.\nThe existence of the index-code MI in the ELBO has been shown before [ 16], and as a result,\nFactorV AE, which uses an equivalent objective to the β-TCV AE, is independently proposed [ 8].\nThe main difference is they estimate the total correlation using the density ratio trick [ 35] which\nrequires an auxiliary discriminator network and an inner optimization loop. In contrast, we emphasize\nthe success of β-V AE using our reﬁned decomposition, and propose a training method that allows\nassigning arbitrary weights to each term of the objective without requiring any additional networks.\nIn a similar vein, non-linear independent component analysis [ 36, 37, 38] studies the problem of\ninverting a generative process assuming independent latent factors. Instead of a perfect inversion, we\nonly aim for maximizing the mutual information between our learned representation and the ground\ntruth factors. Simple priors can further encourage interpretability by means of warping complex\nfactors into simpler manifolds. To the best of our knowledge, we are theﬁrst to show a strong\nquantiﬁable relation between factorial representations and disentanglement (see Section 6).\n6 Experiments\nDataset Ground truth factors\ndSprites scale (6), rotation (40), posX (32), posY (32)\n3D Faces azimuth (21), elevation (11), lighting (11)\nTable 2: Summary of datasets with known ground truth fac-\ntors. Parentheses contain number of quantized values for each\nfactor.\nWe perform a series of quantitative\nand qualitative experiments, show-\ning that β-TCV AE can consistently\nachieve higher MIG scores compared\nto prior methods β-V AE [7] and Info-\nGAN [6], and can match the perfor-\nmance of FactorV AE [8] whilst per-\nforming better in scenarios where the\ndensity ratio trick is difﬁcult to train.\nFurthermore, weﬁnd that in models\ntrained with our method, total corre-\nlation is strongly correlated with disentanglement. 4\nIndependent Factors of VariationFirst, we analyze the performance of our proposedβ-TCV AE\nand MIG metric in a restricted setting, with ground truth factors that are uniformly and independently\nsampled. To paint a clearer picture on the robustness of learning algorithms, we aggregate results\nfrom multiple experiments to visualize the effect of initialization .\nWe perform quantitative evaluations with two datasets, a dataset of 2D shapes [ 39] and a dataset of\nsynthetic 3D faces [ 40]. Their ground truth factors are summarized in Table 2. The dSprites and 3D\nfaces also contain 3 types of shapes and 50 identities, respectively, which are treated as noise during\nevaluation.\nELBO vs. Disentanglement Trade-off Since the β-V AE and β-TCV AE objectives are lower\nbounds on the standard ELBO, we would like to see the effect of training with this modiﬁcation.\nTo see how the choice of β affects these learning algorithms, we train using a range of values. The\ntrade-off between density estimation and the amount of disentanglement measured by MIG is shown\nin Figure 2.\n4Code is available at �������������������������������������� .\n6\n� � � � ��\n���\n���\n���\n���\n��\n��\n��\n����\n� � � � ��\n���\n���\n���\n�������������\n���� ������ �������� � �� ����������������\n(a) dSprites\n� � � � ��\n����\n����\n����\n����\n����\n����\n� � � � ��\n���\n���\n���\n���\n���\n�������������\n���� ������ �������� � �� ���������������� (b) 3D Faces\nFigure 2: Compared to β-V AE,β-TCV AE creates more disentangled representations while preserving\na better generative model of the data with increasing β. Shaded regions show the 90% conﬁdence\nintervals. Higher is better on both metrics.\n��� ������� ���� ��������� ���������\n���\n���\n������������������������\n���������������������������\n(a) dSprites\n��� ������� ���� ��������� ���������\n���\n���\n������������������������\n��������������������������� (b) 3D Faces\nFigure 3: Distribution of disentanglement score\n(MIG) for different modeling algorithms.\n�� �� �� �\n�����������������\n����\n����\n����\n����\n����\n����\n�������\n�������\n�������\n�����\n�������\n(a) dSprites\n�� �� �� �\n�����������������\n���\n���\n���\n���\n������\n�������\n�������\n�����\n������� (b) 3D Faces\nFigure 4: Scatter plots of the average MIG and TC\nper value ofβ. Larger circles indicate a higherβ.\nWeﬁnd that β-TCV AE provides a better trade-off between density estimation and disentanglement.\nNotably, with higher values of β, the mutual information penality in β-V AE is too strong and this\nhinders the usefulness of the latent variables. However, β-TCV AE with higher values ofβ consistently\nresults in models with higher disentanglement score relative toβ-V AE.\nWe also perform ablation studies on the removal of the index-code MI term by setting α= 0\nin (4), and a model using a factorized normalizingﬂow as the prior distribution which is jointly\ntrained to maximize the modiﬁed objective. Neither resulted in signiﬁcant performance difference,\nsuggesting that tuning the weight of the TC term in (2) is the most useful for learning disentangled\nrepresentations.\nQuantitative Comparisons While a disentangled representation may be achievable by some learn-\ning algorithms, the chances of obtaining such a representation typically is not clear. Unsupervised\nlearning of a disentangled representation can have high variance since disentangled labels are not\nprovided during training. To further understand the robustness of each algorithm, we show box\nplots depicting the quartiles of the MIG score distribution for various methods in Figure 3. We\nused β= 4 for β-V AE andβ= 6 for β-TCV AE, based on modes in Figure 2. For InfoGAN, we\nused 5 continuous latent codes and 5 noise variables. Other settings are chosen following those\nsuggested by [ 6], but we also added instance noise [ 41] to stabilize training. FactorV AE uses an\nequivalent objective to the β-TCV AE but is trained with the density ratio trick [ 35], which is known\nto underestimate the TC term [ 8]. As a result, we tuned β∈[1,80] and used double the number of\niterations for FactorV AE. Note that while β-V AE, FactorV AE andβ-TCV AE use a fully connected\narchitecture for the dSprites dataset, InfoGAN uses a convolutional architecture for increased stability.\nWe alsoﬁnd that FactorV AE performs poorly with fully connected layers, resulting in worse results\nthanβ-V AE on the dSprites dataset.\nIn general, weﬁnd that the median score is highest for β-TCV AE and it is close to the highest score\nachieved by all methods. Despite the best half of the β-TCV AE runs achieving relatively high scores,\nwe see that the other half can still perform poorly. Low-score outliers exist in the 3D faces dataset,\nalthough their scores are still higher than the median scores achieved by both V AE and InfoGAN.\nFactorial vs. Disentangled Representations While a low total correlation has been previously\nconjectured to lead to disentanglement, we provide concrete evidence that our β-TCV AE learning\nalgorithm satisﬁes this property. Figure 4 shows a scatter plot of total correlation and the MIG\n7\n�������\n���������\nA\n�������\n��������� B\n�������\n���������\nC\n�������\n��������� D\n(a) Different joint\ndistributions of factors.\n� � � ����\n���\n���\n���\n���\n������������������������\n���������������������������\n������� ���� ������\n(b) Distribution of disentanglement scores (MIG).\nFigure 5: The β-TCV AE has a higher chance of obtaining a disentangled representation than β-\nV AE, even in the presence of sampling bias. (a) All samples have non-zero probability in all joint\ndistributions; the most likely sample is4times as likely as the least likely sample.\ndisentanglement metric for varying values of β trained on the dSprites and faces datasets, averaged\nover 40 random initializations. For models trained withβ-TCV AE, the correlation between average\nTC and average MIG is strongly negative, while models trained with β-V AE have a weaker correlation.\nIn general, for the same degree of total correlation, β-TCV AE creates a better disentangled model.\nThis is also strong evidence for the hypothesis that large values of β can be useful as long as the\nindex-code mutual information is not penalized.\n6.1 Correlated or Dependent Factors\nA notion of disentanglement can exist even when the underlying generative process samples factors\nnon-uniformly and dependently sampled. Many real datasets exhibit this behavior, where some con-\nﬁgurations of factors are sampled more than others, violating the statistical independence assumption.\nDisentangling the factors of variation in this case corresponds toﬁnding the generative model where\nthe latent factors can independently act and perturb the generated result, even when there is bias in\nthe sampling procedure. In general, weﬁnd that β-TCV AE has no problem inﬁnding the correct\nfactors of variation in a toy dataset and canﬁnd more interpretable factors of variation than those\nfound in prior work, even though the independence assumption is violated.\nTwo Factors We start off with a toy dataset with only two factors and test β-TCV AE using\nsampling distributions with varying degrees of correlation and dependence. We take the dataset of\nsynthetic 3D faces andﬁx all factors other than pose. The joint distributions over factors that we test\nwith are summarized in Figure 5a, which includes varying degrees of sampling bias. Speciﬁcally,\nconﬁguration A uses uniform and independent factors; B uses factors with non-uniform marginals but\nare uncorrelated and independent; C uses uncorrelated but dependent factors; and D uses correlated\nand dependent factors. While it is possible to train a disentangled model in all conﬁgurations, the\nchances of obtaining one is overall lower when there exist sampling bias. Across all conﬁgurations,\nwe see that β-TCV AE is superior toβ-V AE and InfoGAN, and there is a large difference in median\nscores for most conﬁgurations.\n6.1.1 Qualitative Comparisons\nWe show qualitatively that β-TCV AE discovers more disentangled factors than β-V AE on datasets of\nchairs [42] and real faces [ 43].\n3D Chairs Figure 6 shows traversals in latent variables that depict an interpretable property in\ngenerating 3D chairs. The β-V AE [7] has shown to be capable of learning theﬁrst four properties:\nazimuth, size, leg style, and backrest. However, the leg style change learned by β-V AE does not seem\nto be consistent for all chairs. Weﬁnd that β-TCV AE can learn two additional interpretable properties:\nmaterial of the chair, and leg rotation for swivel chairs. These two properties are more subtle and\nlikely require a higher index-code mutual information, so the lower penalization of index-code MI in\nβ-TCV AE helps inﬁnding these properties.\n8\nβ-V AE\nβ-TCV AE\n(a) Azimuth\n (b) Chair size\n (c) Leg style\n (d) Backrest\n (e) Material\n (f) Swivel\nFigure 6: Learned latent variables using β-V AE andβ-TCV AE are shown. Traversal range is (-2, 2).\nCelebA Figure 1 shows 4 out of 15 attributes that are discovered by the β-TCV AE without super-\nvision (see Appendix A.3). We traverse up to six standard deviations away from the mean to show\nthe effect of generalizing the represented semantics of each variable. The representation learned\nby β-V AE is entangled with nuances, which can be shown when generalizing to low probability\nregions. For instance, it has difﬁculty rendering complete baldness or narrow face width, whereas the\nβ-TCV AE shows meaningful extrapolation. The extrapolation of the gender attribute of β-TCV AE\nshows that it focuses more on gender-speciﬁc facial features, whereas the β-V AE is entangled with\nmany irrelevances such as face width. The ability to generalize beyond theﬁrst few standard devia-\ntions of the prior mean implies that the β-TCV AE model can generate rare samples such asbald or\nmustached females.\n7 Conclusion\nWe present a decomposition of the ELBO with the goal of explaining why β-V AE works. In particular,\nweﬁnd that a TC penalty in the objective encourages the model toﬁnd statistically independent\nfactors in the data distribution. We then designate a special case as β-TCV AE, which can be trained\nstochastically using minibatch estimator with no additional hyperparameters compared to the β-V AE.\nThe simplicity of our method allows easy integration into different frameworks [ 44].To quantitatively\nevaluate our approach, we propose a classiﬁer-free disentanglement metric called MIG. This metric\nbeneﬁts from advances in efﬁcient computation of mutual information [ 23] and enforces compactness\nin addition to disentanglement. Unsupervised learning of disentangled representations is inherently\na difﬁcult problem due to the lack of a prior for semantic awareness, but we show some evidence\nin simple datasets with uniform factors that independence between latent variables can be strongly\nrelated to disentanglement.\nAcknowledgements\nWe thank Alireza Makhzani, Y uxing Zhang, and Bowen Xu for initial discussions. We also thank\nChatavut Viriyasuthee for pointing out an error in one of our derivations. Ricky would also like to\nthank Brendan Shillingford for supplying accommodation at a popular conference.\nReferences\n[1] Jürgen Schmidhuber. Learning factorial codes by predictability minimization.Neural Computation,\n4(6):863–879, 1992.\n[2] Karl Ridgeway. A survey of inductive biases for factorial representation-learning.arXiv preprint\narXiv:1612.05299, 2016.\n[3] Alessandro Achille and Stefano Soatto. On the emergence of invariance and disentangling in deep\nrepresentations.arXiv preprint arXiv:1706.01350, 2017.\n[4] Y oshua Bengio, Aaron Courville, and Pascal Vincent. Representation learning: A review and new\nperspectives.IEEE transactions on pattern analysis and machine intelligence, 35(8):1798–1828, 2013.\n9\n[5] Alexander A Alemi, Ian Fischer, Joshua V Dillon, and Kevin Murphy. Deep variational information\nbottleneck.International Conference on Learning Representations, 2017.\n[6] Xi Chen, Y an Duan, Rein Houthooft, John Schulman, Ilya Sutskever, and Pieter Abbeel. Infogan:\nInterpretable representation learning by information maximizing generative adversarial nets. InAdvances\nin Neural Information Processing Systems, pages 2172–2180, 2016.\n[7] Irina Higgins, Loic Matthey, Arka Pal, Christopher Burgess, Xavier Glorot, Matthew Botvinick, Shakir\nMohamed, and Alexander Lerchner. beta-vae: Learning basic visual concepts with a constrained variational\nframework.International Conference on Learning Representations, 2017.\n[8] Hyunjik Kim and Andriy Mnih. Disentangling by factorising.arXiv preprint arXiv:1802.05983, 2018.\n[9] Diederik P Kingma and Max Welling. Auto-encoding variational bayes.arXiv preprint arXiv:1312.6114,\n2013.\n[10] Danilo Jimenez Rezende, Shakir Mohamed, and Daan Wierstra. Stochastic backpropagation and approxi-\nmate inference in deep generative models.arXiv preprint arXiv:1401.4082, 2014.\n[11] Ian Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley, Sherjil Ozair, Aaron\nCourville, and Y oshua Bengio. Generative adversarial nets. InAdvances in neural information processing\nsystems, pages 2672–2680, 2014.\n[12] Will Grathwohl and Aaron Wilson. Disentangling space and time in video with hierarchical variational\nauto-encoders.arXiv preprint arXiv:1612.04440, 2016.\n[13] Christopher K. I. Williams Cian Eastwood. A framework for the quantitative evaluation of disentangled\nrepresentations.International Conference on Learning Representations, 2018.\n[14] Xavier Glorot, Antoine Bordes, and Y oshua Bengio. Domain adaptation for large-scale sentiment clas-\nsiﬁcation: A deep learning approach. InProceedings of the 28th international conference on machine\nlearning (ICML-11), pages 513–520, 2011.\n[15] Theofanis Karaletsos, Serge Belongie, and Gunnar Rätsch. Bayesian representation learning with oracle\nconstraints.International Conference on Learning Representations, 2016.\n[16] Matthew D Hoffman and Matthew J Johnson. Elbo surgery: yet another way to carve up the variational\nevidence lower bound. InWorkshop in Advances in Approximate Bayesian Inference, NIPS, 2016.\n[17] Alireza Makhzani, Jonathon Shlens, Navdeep Jaitly, Ian Goodfellow, and Brendan Frey. Adversarial\nautoencoders.ICLR 2016 Workshop, International Conference on Learning Representations, 2016.\n[18] Shengjia Zhao, Jiaming Song, and Stefano Ermon. Infovae: Information maximizing variational autoen-\ncoders.arXiv preprint arXiv:1706.02262, 2017.\n[19] Christopher Burgess, Irina Higgins, Arka Pal, Loic Matthey, Nick Watters, Guillaume Desjardins, and\nAlexander Lerchner. Understanding disentangling in beta-vae.Learning Disentangled Representations:\nFrom Perception to Control Workshop, 2017.\n[20] Satosi Watanabe. Information theoretical analysis of multivariate correlation.IBM Journal of research and\ndevelopment, 4(1):66–82, 1960.\n[21] Geoffrey E Hinton and Richard S Zemel. Autoencoders, minimum description length and helmholtz free\nenergy. InAdvances in neural information processing systems, pages 3–10, 1994.\n[22] Alessandro Achille and Stefano Soatto. Information dropout: Learning optimal representations through\nnoisy computation.IEEE Transactions on Pattern Analysis and Machine Intelligence, 2018.\n[23] Ishmael Belghazi, Sai Rajeswar, Aristide Baratin, R Devon Hjelm, and Aaron Courville. MINE: Mutual\ninformation neural estimation.arXiv preprint arXiv:1801.04062, 2018.\n[24] David N Reshef, Y akir A Reshef, Hilary K Finucane, Sharon R Grossman, Gilean McV ean, Peter J\nTurnbaugh, Eric S Lander, Michael Mitzenmacher, and Pardis C Sabeti. Detecting novel associations in\nlarge data sets.science, 334(6062):1518–1524, 2011.\n[25] Geoffrey E Hinton, Alex Krizhevsky, and Sida D Wang. Transforming auto-encoders. InInternational\nConference on Artiﬁcial Neural Networks, pages 44–51. Springer, 2011.\n[26] Tejas D Kulkarni, William F Whitney, Pushmeet Kohli, and Josh Tenenbaum. Deep convolutional inverse\ngraphics network. InAdvances in Neural Information Processing Systems, pages 2539–2547, 2015.\n[27] Brian Cheung, Jesse A Livezey, Arjun K Bansal, and Bruno A Olshausen. Discovering hidden factors of\nvariation in deep networks.arXiv preprint arXiv:1412.6583, 2014.\n[28] Ramakrishna V edantam, Ian Fischer, Jonathan Huang, and Kevin Murphy. Generative models of visually\ngrounded imagination.International Conference on Learning Representations, 2018.\n[29] Alec Radford, Luke Metz, and Soumith Chintala. Unsupervised representation learning with deep\nconvolutional generative adversarial networks.arXiv preprint arXiv:1511.06434, 2015.\n10\n[30] Yichuan Tang, Ruslan Salakhutdinov, and Geoffrey Hinton. Tensor analyzers. InInternational Conference\non Machine Learning, pages 163–171, 2013.\n[31] Guillaume Desjardins, Aaron Courville, and Y oshua Bengio. Disentangling factors of variation via\ngenerative entangling.arXiv preprint arXiv:1210.5474, 2012.\n[32] Greg V er Steeg and Aram Galstyan. Maximally informative hierarchical representations of high-\ndimensional data. InArtiﬁcial Intelligence and Statistics, pages 1004–1012, 2015.\n[33] Abhishek Kumar, Prasanna Sattigeri, and Avinash Balakrishnan. V ariational inference of disentangled\nlatent concepts from unlabeled observations.arXiv preprint arXiv:1711.00848, 2017.\n[34] Shuyang Gao, Rob Brekelmans, Greg V er Steeg, and Aram Galstyan. Auto-encoding total correlation\nexplanation.arXiv preprint arXiv:1802.05822, 2018.\n[35] Masashi Sugiyama, Taiji Suzuki, and Takafumi Kanamori.Density ratio estimation in machine learning.\nCambridge University Press, 2012.\n[36] Pierre Comon. Independent component analysis, a new concept?Signal processing, 36(3):287–314, 1994.\n[37] Aapo Hyvärinen and Petteri Pajunen. Nonlinear independent component analysis: Existence and uniqueness\nresults.Neural Networks, 12(3):429–439, 1999.\n[38] Christian Jutten and Juha Karhunen. Advances in nonlinear blind source separation. InProc. of the 4th Int.\nSymp. on Independent Component Analysis and Blind Signal Separation, 2003.\n[39] Loic Matthey, Irina Higgins, Demis Hassabis, and Alexander Lerchner. dsprites: Disentanglement testing\nsprites dataset. https://github.com/deepmind/dsprites-dataset/, 2017.\n[40] Pascal Paysan, Reinhard Knothe, Brian Amberg, Sami Romdhani, and Thomas V etter. A 3d face model for\npose and illumination invariant face recognition. InAdvanced Video and Signal Based Surveillance, 2009.\nA VSS’09. Sixth IEEE International Conference on, pages 296–301. Ieee, 2009.\n[41] Casper Kaae Sønderby, Jose Caballero, Lucas Theis, Wenzhe Shi, and Ferenc Huszár. Amortised map\ninference for image super-resolution.International Conference on Learning Representations, 2017.\n[42] Mathieu Aubry, Daniel Maturana, Alexei Efros, Bryan Russell, and Josef Sivic. Seeing 3d chairs: exemplar\npart-based 2d-3d alignment using a large dataset of cad models. InCVPR, 2014.\n[43] Ziwei Liu, Ping Luo, Xiaogang Wang, and Xiaoou Tang. Deep learning face attributes in the wild. In\nProceedings of the IEEE International Conference on Computer Vision, pages 3730–3738, 2015.\n[44] Jin Xu and Y ee Whye Teh. Controllable semantic image inpainting.arXiv preprint arXiv:1806.05953,\n2018.\n11",
  "values": {
    "Critiqability": "No",
    "User influence": "No",
    "Explicability": "No",
    "Interpretable (to users)": "No",
    "Autonomy (power to decide)": "No",
    "Non-maleficence": "No",
    "Not socially biased": "No",
    "Transparent (to users)": "No",
    "Privacy": "No",
    "Deferral to humans": "No",
    "Justice": "No",
    "Fairness": "No",
    "Respect for Persons": "No",
    "Respect for Law and public interest": "No",
    "Beneficence": "No",
    "Collective influence": "No"
  }
}