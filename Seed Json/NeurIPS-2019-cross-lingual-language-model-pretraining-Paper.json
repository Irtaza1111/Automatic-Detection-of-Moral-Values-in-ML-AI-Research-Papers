{
  "pdf": "NeurIPS-2019-cross-lingual-language-model-pretraining-Paper",
  "title": "Cross-lingual Language Model Pretraining",
  "author": "Alexis CONNEAU, Guillaume Lample",
  "paper_id": "NeurIPS-2019-cross-lingual-language-model-pretraining-Paper",
  "text": "Cross-lingual Language Model Pretraining\nAlexis Conneau∗\nFacebook AI Research\nUniversité Le Mans\naconneau@fb.com\nGuillaume Lample∗\nFacebook AI Research\nSorbonne Universités\nglample@fb.com\nAbstract\nRecent studies have demonstrated the efﬁciency of generative pretraining for En-\nglish natural language understanding. In this work, we extend this approach to\nmultiple languages and show the effectiveness of cross-lingual pretraining. We\npropose two methods to learn cross-lingual language models (XLMs): one unsu-\npervised that only relies on monolingual data, and one supervised that leverages\nparallel data with a new cross-lingual language model objective. We obtain state-of-\nthe-art results on cross-lingual classiﬁcation, unsupervised and supervised machine\ntranslation. On XNLI, our approach pushes the state of the art by an absolute gain\nof 4.9% accuracy. On unsupervised machine translation, we obtain 34.3 BLEU on\nWMT’16 German-English, improving the previous state of the art by more than 9\nBLEU. On supervised machine translation, we obtain a new state of the art of 38.5\nBLEU on WMT’16 Romanian-English, outperforming the previous best approach\nby more than 4 BLEU. Our code and pretrained models are publicly available1.\n1 Introduction\nGenerative pretraining of sentence encoders [30, 20, 14] has led to strong improvements on numerous\nnatural language understanding benchmarks [40]. In this context, a Transformer [38] language model\nis learned on a large unsupervised text corpus, and then ﬁne-tuned on natural language understanding\n(NLU) tasks such as classiﬁcation [35] or natural language inference [ 7, 42]. Although there has\nbeen a surge of interest in learning general-purpose sentence representations, research in that area\nhas been essentially monolingual, and largely focused around English benchmarks [10, 40]. Recent\ndevelopments in learning and evaluating cross-lingual sentence representations in many languages\n[12] aim at mitigating the English-centric bias and suggest that it is possible to build universal\ncross-lingual encoders that can encode any sentence into a shared embedding space.\nIn this work, we demonstrate the effectiveness of cross-lingual language model pretraining on multiple\ncross-lingual understanding (XLU) benchmarks. Precisely, we make the following contributions:\n1. We introduce a new unsupervised method for learning cross-lingual representations using\ncross-lingual language modeling and investigate two monolingual pretraining objectives.\n2. We introduce a new supervised learning objective that improves cross-lingual pretraining\nwhen parallel data is available.\n3. We signiﬁcantly outperform the previous state of the art on cross-lingual classiﬁcation,\nunsupervised machine translation and supervised machine translation.\n4. We show that cross-lingual language models can provide signiﬁcant improvements on the\nperplexity of low-resource languages.\n5. We make our code and pretrained models publicly available 1.\n∗ Equal contribution.\n1https://github.com/facebookresearch/XLM\n33rd Conference on Neural Information Processing Systems (NeurIPS 2019), Vancouver, Canada.\n2 Related Work\nOur work builds on top of Radford et al. [30], Howard and Ruder [20], Devlin et al. [14] who\ninvestigate language modeling for pretraining Transformer encoders. Their approaches lead to drastic\nimprovements on several classiﬁcation tasks from the GLUE benchmark [40]. Ramachandran et al.\n[31] show that language modeling pretraining can also provide signiﬁcant improvements on machine\ntranslation tasks, even for high-resource language pairs such as English-German where there exists a\nsigniﬁcant amount of parallel data. Concurrent to our work, results on cross-lingual classiﬁcation\nusing a cross-lingual language modeling approach were showcased on the BERT repository . We\ncompare those results to our approach in Section 5.\nAligning distributions of text representations has a long tradition, starting from word embeddings\nalignment and the work of Mikolov et al. [27] that leverages small dictionaries to align word\nrepresentations from different languages. A series of follow-up studies show that cross-lingual\nrepresentations can be used to improve the quality of monolingual representations [16], that orthogonal\ntransformations are sufﬁcient to align these word distributions [43], and that all these techniques\ncan be applied to an arbitrary number of languages [ 2]. Following this line of work, the need for\ncross-lingual supervision was further reduced [34] until it was completely removed [11]. We take\nthese ideas one step further by aligning distributions of sentences and also reducing the need for\nparallel data.\nThere is a large body of work on aligning sentence representations from multiple languages. By\nusing parallel data, Hermann and Blunsom [18], Conneau et al. [12], Eriguchi et al. [15] investigated\nzero-shot cross-lingual sentence classiﬁcation. But the most successful recent approach of cross-\nlingual encoders is probably the one of Johnson et al. [21] for multilingual machine translation.\nThey show that a single sequence-to-sequence model can be used to perform machine translation\nfor many language pairs, by using a single shared LSTM encoder and decoder. Their multilingual\nmodel outperformed the state of the art on low-resource language pairs, and enabled zero-shot\ntranslation. Following this approach, Artetxe and Schwenk [4] show that the resulting encoder can be\nused to produce cross-lingual sentence embeddings. By leveraging more than 200 million parallel\nsentences, they obtain a new state of the art on the XNLI cross-lingual classiﬁcation benchmark\n[12]. While these methods require a signiﬁcant amount of parallel data, recent work in unsupervised\nmachine translation show that sentence representations can be aligned in a completely unsupervised\nway [25, 5]. For instance, Lample et al. [26] obtained 25.2 BLEU on WMT’16 German-English\nwithout using parallel sentences. Similarly, we show that we can align distributions of sentences in a\ncompletely unsupervised way, and that our cross-lingual models can be used for a broad set of natural\nlanguage understanding tasks, including machine translation.\nThe most similar work to ours is probably the one of Wada and Iwata [39], where the authors train a\nLSTM [19] language model with sentences from different languages to align word embeddings in an\nunsupervised way.\n3 Cross-lingual language models\nIn this section, we present the three language modeling objectives we consider throughout this work.\nTwo of them only require monolingual data (unsupervised), while the third one requires parallel\nsentences (supervised). We considerN languages. Unless stated otherwise, we suppose that we have\nN monolingual corpora{Ci}i=1...N , and we denote byni the number of sentences inCi.\n3.1 Shared sub-word vocabulary\nIn all our experiments we process all languages with the same shared vocabulary created through Byte\nPair Encoding (BPE) [32]. As shown in Lample et al. [25], this greatly improves the alignment of\nembedding spaces across languages that share either the same alphabet or anchor tokens such as digits\n[34] or proper nouns. We learn the BPE splits on the concatenation of sentences sampled randomly\nfrom the monolingual corpora. Sentences are sampled according to a multinomial distribution with\nprobabilities{qi}i=1...N , where: qi = pα\ni∑N\nj=1 pα\nj\nwith pi = ni∑N\nk=1 nk\n. We consider α = 0.5.\nSampling with this distribution increases the number of tokens associated to low-resource languages\n2\nand alleviates the bias towards high-resource languages. In particular, this prevents words of low-\nresource languages from being split at the character level.\n3.2 Causal Language Modeling (CLM)\nOur causal language modeling (CLM) task consists of a Transformer language model trained to model\nthe probability of a word given the previous words in a sentence P (wt|w1,...,w t−1,θ ). While\nrecurrent neural networks obtain state-of-the-art performance on language modeling benchmarks\n[22], Transformer models are also very competitive [ 13]. In the case of LSTM language models,\nback-propagation through time [41] (BPTT) is performed by providing the LSTM with the last hidden\nstate of the previous iteration. In the case of Transformers, previous hidden states can be passed to\nthe current batch [1] to provide context to the ﬁrst words in the batch. However, this technique does\nnot scale to the cross-lingual setting, so we just leave the ﬁrst words in each batch without context for\nsimplicity.\n3.3 Masked Language Modeling (MLM)\nWe also consider the masked language modeling (MLM) objective of Devlin et al.[14], also known as\nthe Cloze task [36]. Following Devlin et al. [14], we sample randomly 15% of the BPE tokens from\nthe text streams, replace them by a [MASK] token 80% of the time, by a random token 10% of the\ntime, and we keep them unchanged 10% of the time. Differences between our approach and the MLM\nof Devlin et al. [14] include the use of text streams of an arbitrary number of sentences (truncated at\n256 tokens) instead of pairs of sentences. To counter the imbalance between rare and frequent tokens\n(e.g. punctuations or stop words), we also subsample the frequent outputs using an approach similar\nto Mikolov et al. [28]: tokens in a text stream are sampled according to a multinomial distribution,\nwhose weights are proportional to the square root of their invert frequencies. Our MLM objective is\nillustrated in Figure 1.\n3.4 Translation Language Modeling (TLM)\nBoth the CLM and MLM objectives are unsupervised and only require monolingual data. However,\nthese objectives cannot be used to leverage parallel data when it is available. We introduce a new\ntranslation language modeling (TLM) objective for improving cross-lingual pretraining. Our TLM\nobjective is an extension of MLM, where instead of considering monolingual text streams, we\nconcatenate parallel sentences as illustrated in Figure 1. We randomly mask words in both the source\nand target sentences. To predict a word masked in an English sentence, the model can either attend to\nsurrounding English words or to the French translation, encouraging the model to align the English\nand French representations. In particular, the model can leverage the French context if the English\none is not sufﬁcient to infer the masked English words. To facilitate the alignment, we also reset the\npositions of target sentences.\n3.5 Cross-lingual Language Models\nIn this work, we consider cross-lingual language model pretraining with either CLM, MLM, or MLM\nused in combination with TLM. For the CLM and MLM objectives, we train the model with batches\nof 64 streams of continuous sentences composed of 256 tokens. At each iteration, a batch is composed\nof sentences coming from the same language, which is sampled from the distribution {qi}i=1...N\nabove, withα = 0.7. When TLM is used in combination with MLM, we alternate between these two\nobjectives, and sample the language pairs with a similar approach.\n4 Cross-lingual language model pretraining\nIn this section, we explain how cross-lingual language models can be used to obtain:\n• a better initialization of sentence encoders for zero-shot cross-lingual classiﬁcation\n• a better initialization of supervised and unsupervised neural machine translation systems\n• language models for low-resource languages\n• unsupervised cross-lingual word embeddings\n3\n[/s] the [MASK] [MASK] blue [/s] [MASK] rideaux étaient [MASK] \n0 1 2 3 4 5\nen en en en en en\ncurtains les\n[/s] \n1 2 3 4 5\n[/s] \n0\nfr fr fr fr fr fr \nbleus\nTransformer\nTransformer\nToken\nembeddings\ntake drink now[/s]\n[/s] [MASK] a seat have a [MASK] [/s] [MASK] [MASK] relax and\n0 1 2 3 4 5\nen en en en en en\n7 8 9 10 116\nen en en en en en \n+\nPosition\nembeddings\nLanguage\nembeddings\nMasked Language\nModeling (MLM)\n+ + + + + + + + + + +\n+ + + + + + + + + + + +\n+ + + + + + + + + + + +\n+ + + + + + + + + + + +\nToken\nembeddings\nPosition\nembeddings\nLanguage\nembeddings\nTranslation Language\nModeling (TLM) were\nFigure 1: Cross-lingual language model pretraining. The MLM objective is similar to the one of Devlin\net al. [14], but with continuous streams of text as opposed to sentence pairs. The TLM objective extends MLM to\npairs of parallel sentences. To predict a masked English word, the model can attend to both the English sentence\nand its French translation, and is encouraged to align English and French representations. Position embeddings\nof the target sentence are reset to facilitate the alignment.\n4.1 Cross-lingual classiﬁcation\nOur pretrained XLM models provide general-purpose cross-lingual text representations. Similar to\nmonolingual language model ﬁne-tuning [30, 14] on English classiﬁcation tasks, we ﬁne-tune XLMs\non a cross-lingual classiﬁcation benchmark. We use the cross-lingual natural language inference\n(XNLI) dataset to evaluate our approach. Precisely, we add a linear classiﬁer on top of the ﬁrst\nhidden state of the pretrained Transformer, and ﬁne-tune all parameters on the English NLI training\ndataset. We then evaluate the capacity of our model to make correct NLI predictions in the 15 XNLI\nlanguages. Following Conneau et al. [12], we also include machine translation baselines of train and\ntest sets. We report our results in Table 1.\n4.2 Unsupervised Machine Translation\nPretraining is a key ingredient of unsupervised neural machine translation (UNMT) [25, 5]. Lample\net al. [26] show that the quality of pretrained cross-lingual word embeddings used to initialize the\nlookup table has a signiﬁcant impact on the performance of an unsupervised machine translation\nmodel. We propose to take this idea one step further by pretraining the entire encoder and decoder\nwith a cross-lingual language model to bootstrap the iterative process of UNMT. We explore various\ninitialization schemes and evaluate their impact on several standard machine translation benchmarks,\nincluding WMT’14 English-French, WMT’16 English-German and WMT’16 English-Romanian.\nResults are presented in Table 2.\n4.3 Supervised Machine Translation\nWe also investigate the impact of cross-lingual language modeling pretraining for supervised machine\ntranslation, and extend the approach of Ramachandran et al. [31] to multilingual NMT [ 21]. We\nevaluate the impact of both CLM and MLM pretraining on WMT’16 Romanian-English, and present\nresults in Table 3.\n4\n4.4 Low-resource language modeling\nFor low-resource languages, it is often beneﬁcial to leverage data in similar but higher-resource\nlanguages, especially when they share a signiﬁcant fraction of their vocabularies. For instance, there\nare about 100k sentences written in Nepali on Wikipedia, and about 6 times more in Hindi. These\ntwo languages also have more than 80% of their tokens in common in a shared BPE vocabulary of\n100k subword units. We provide in Table 4 a comparison in perplexity between a Nepali language\nmodel and a cross-lingual language model trained in Nepali but enriched with different combinations\nof Hindi and English data.\n4.5 Unsupervised cross-lingual word embeddings\nConneau et al. [11] showed how to perform unsupervised word translation by aligning monolingual\nword embedding spaces with adversarial training (MUSE). Lample et al. [25] showed that using a\nshared vocabulary between two languages and then applying fastText [6] on the concatenation of their\nmonolingual corpora also directly provides high-quality cross-lingual word embeddings (Concat)\nfor languages that share a common alphabet. In this work, we also use a shared vocabulary but our\nword embeddings are obtained via the lookup table of our cross-lingual language model (XLM).\nIn Section 5, we compare these three approaches on three different metrics: cosine similarity, L2\ndistance and cross-lingual word similarity.\n5 Experiments and results\nIn this section, we empirically demonstrate the strong impact of cross-lingual language model\npretraining on several benchmarks, and compare our approach to the current state of the art.\n5.1 Training details\nIn all experiments, we use a Transformer architecture with 1024 hidden units, 8 heads, GELU\nactivations [17], a dropout rate of 0.1 and learned positional embeddings. We train our models with\nthe Adam optimizer [23], a linear warm-up [38] and learning rates varying from 10−4 to 5.10−4.\nFor the CLM and MLM objectives, we use streams of 256 tokens and a mini-batches of size 64.\nUnlike Devlin et al.[14], a sequence in a mini-batch can contain more than two consecutive sentences,\nas explained in Section 3.2. For the TLM objective, we sample mini-batches of4000 tokens composed\nof sentences with similar lengths. We use the averaged perplexity over languages as a stopping\ncriterion for training. For machine translation, we only use 6 layers, and we create mini-batches of\n2000 tokens.\nWhen ﬁne-tuning on XNLI, we use mini-batches of size 8 or 16, and we clip the sentence length\nto 256 words. We use 80k BPE splits and a vocabulary of 95k and train a 12-layer model on the\nWikipedias of the XNLI languages. We sample the learning rate of the Adam optimizer with values\nfrom 5.10−4 to 2.10−4, and use small evaluation epochs of 20000 random samples. We use the\nﬁrst hidden state of the last layer of the transformer as input to the randomly initialized ﬁnal linear\nclassiﬁer, and ﬁne-tune all parameters. In our experiments, using either max-pooling or mean-pooling\nover the last layer did not work better than using the ﬁrst hidden state.\nWe implement all our models in PyTorch [29], and train them on 64 V olta GPUs for the language\nmodeling tasks, and 8 GPUs for the MT tasks. We use ﬂoat16 operations to speed up training and to\nreduce the memory usage of our models.\n5.2 Data preprocessing\nWe use WikiExtractor to extract raw sentences from Wikipedia dumps and use them as monolingual\ndata for the CLM and MLM objectives. For the TLM objective, we only use parallel data that\ninvolves English, similar to Conneau et al. [12]. Precisely, we use MultiUN [44] for French, Spanish,\nRussian, Arabic and Chinese, and the IIT Bombay corpus [3] for Hindi. We extract the following\ncorpora from the OPUS website Tiedemann [37]: the EUbookshop corpus for German, Greek and\nBulgarian, OpenSubtitles 2018 for Turkish, Vietnamese and Thai, Tanzil for both Urdu and Swahili\nand GlobalV oices for Swahili. For Chinese and Thai we respectively use the tokenizer of Chang\n5\nen fr es de el bg ru tr ar vi th zh hi sw ur ∆\nMachine translation baselines (TRANSLATE-TRAIN)\nDevlin et al. [14] 81.9 - 77.8 75.9 - - - - 70.7 - - 76.6 - - 61.6 -XLM (MLM+TLM)85.0 80.2 80.8 80.3 78.1 79.3 78.1 74.7 76.5 76.6 75.5 78.6 72.3 70.9 63.2 76.7\nMachine translation baselines (TRANSLATE-TEST)\nDevlin et al. [14] 81.4 - 74.9 74.4 - - - - 70.4 - - 70.1 - - 62.1 -XLM (MLM+TLM)85.0 79.0 79.5 78.1 77.8 77.6 75.5 73.7 73.7 70.8 70.4 73.6 69.0 64.7 65.174.2\nEvaluation of cross-lingual sentence encoders\nConneau et al. [12]73.7 67.7 68.7 67.7 68.9 67.9 65.4 64.2 64.8 66.4 64.1 65.8 64.1 55.7 58.465.6Devlin et al. [14] 81.4 - 74.3 70.5 - - - - 62.1 - - 63.8 - - 58.3 -Artetxe and Schwenk [4]73.9 71.9 72.9 72.6 73.1 74.2 71.5 69.7 71.4 72.0 69.2 71.4 65.5 62.2 61.070.2XLM (MLM) 83.2 76.5 76.3 74.2 73.1 74.0 73.1 67.8 68.5 71.2 69.2 71.9 65.7 64.6 63.471.5XLM (MLM+TLM)85.0 78.7 78.9 77.8 76.6 77.4 75.3 72.5 73.1 76.1 73.2 76.5 69.6 68.4 67.375.1\nTable 1: Results on cross-lingual classiﬁcation accuracy. Test accuracy on the 15 XNLI languages.\nWe report results for machine translation baselines and zero-shot classiﬁcation approaches based on\ncross-lingual sentence encoders. XLM (MLM) corresponds to our unsupervised approach trained\nonly on monolingual corpora, and XLM (MLM+TLM) corresponds to our supervised method that\nleverages both monolingual and parallel data through the TLM objective. ∆ corresponds to the\naverage accuracy.\net al. [9], and the PyThaiNLP tokenizer. For all other languages, we use the tokenizer provided by\nMoses [24], falling back on the default English tokenizer when necessary. We use fastBPE to learn\nBPE codes and split words into subword units. The BPE codes are learned on the concatenation of\nsentences sampled from all languages, following the method presented in Section 3.1.\n5.3 Results and analysis\nIn this section, we demonstrate the effectiveness of cross-lingual language model pretraining. Our\napproach signiﬁcantly outperforms the previous state of the art on cross-lingual classiﬁcation, unsu-\npervised and supervised machine translation.\nCross-lingual classiﬁcation In Table 1, we evaluate two types of pretrained cross-lingual encoders:\nan unsupervised cross-lingual language model that uses the MLM objective on monolingual corpora\nonly; and a supervised cross-lingual language model that combines both the MLM and the TLM loss\nusing additional parallel data. Following Conneau et al. [12], we include two machine translation\nbaselines: TRANSLATE-TRAIN, where the English MultiNLI training set is machine translated into\neach XNLI language, and TRANSLATE-TEST where every dev and test set of XNLI is translated to\nEnglish. We report the XNLI baselines of Conneau et al. [12], the multilingual BERT approach of\nDevlin et al. [14] and the recent work of Artetxe and Schwenk [4].\nOur fully unsupervised MLM method sets a new state of the art on zero-shot cross-lingual classiﬁca-\ntion and signiﬁcantly outperforms the supervised approach of Artetxe and Schwenk [4] which uses\n223 million of parallel sentences. Precisely, MLM obtains 71.5% accuracy on average (∆), while\nthey obtained 70.2% accuracy. By leveraging parallel data through the TLM objective (MLM+TLM),\nwe get a signiﬁcant boost in performance of 3.6% accuracy, improving even further the state of the\nart to 75.1%. On the Swahili and Urdu low-resource languages, we outperform the previous state\nof the art by 6.2% and 6.3% respectively. Using TLM in addition to MLM also improves English\naccuracy from 83.2% to 85% accuracy, outperforming Artetxe and Schwenk [4] and Devlin et al.\n[14] by 11.1% and 3.6% accuracy respectively.\nWhen ﬁne-tuned on the training set of each XNLI language (TRANSLATE-TRAIN), our supervised\nmodel outperforms our zero-shot approach by 1.6%, reaching an absolute state of the art of 76.7%\naverage accuracy. This result demonstrates the consistency of our approach and shows that XLMs\ncan be ﬁne-tuned on any language with strong performance. Similar to multilingual BERT [14], we\nobserve that TRANSLATE-TRAIN outperforms TRANSLATE-TEST by 2.5% average accuracy, and\nadditionally that our zero-shot approach outperforms TRANSLATE-TEST by 0.9%.\nUnsupervised machine translation For the unsupervised machine translation task we consider 3\nlanguage pairs: English-French, English-German, and English-Romanian. Our setting is identical to\nthe one of Lample et al. [26], except for the initialization step where we use cross-lingual language\nmodeling to pretrain the full model as opposed to only the lookup table.\n6\nen-fr fr-en en-de de-en en-ro ro-en\nPrevious state-of-the-art - Lample et al. [26]\nNMT 25.1 24 .2 17.2 21 .0 21.2 19 .4\nPBSMT 28.1 27 .2 17.8 22 .7 21.3 23 .0\nPBSMT + NMT 27.6 27 .7 20.2 25 .2 25.1 23 .9\nOur results for different encoder and decoder initializations\n- - 13.0 15 .8 6.7 15 .3 18.9 18 .3\nEMB EMB 29.4 29 .4 21.3 27 .3 27.5 26 .6\nCLM CLM 30.4 30 .0 22.7 30 .5 29.0 27 .8\nMLM MLM 33.4 33 .3 26.4 34 .3 33.3 31 .8\nCLM - 28.7 28 .2 24.4 30 .3 29.2 28 .0\nMLM - 31.6 32 .1 27.0 33.2 31.8 30 .5\n- CLM 25.3 26 .4 19.2 26 .0 25.7 24 .6\n- MLM 29.2 29 .1 21.6 28 .6 28.2 27 .3\nCLM MLM 32.3 31 .6 24.3 32 .5 31.6 29 .8\nMLM CLM 33.4 32.3 24.9 32 .9 31.7 30 .4\nTable 2: Results on unsupervised MT. BLEU scores on WMT’14 English-French, WMT’16\nGerman-English and WMT’16 Romanian-English. For our results, the ﬁrst two columns indicate the\nmodel used to pretrain the encoder and the decoder. “ - ” means the model was randomly initialized.\nEMB corresponds to pretraining the lookup table with cross-lingual embeddings, CLM and MLM\ncorrespond to pretraining with models trained on the CLM or MLM objectives.\nFor both the encoder and the decoder, we consider different possible initializations: CLM pretraining,\nMLM pretraining, or random initialization. We then follow Lample et al. [26] and train the model\nwith a denoising auto-encoding loss along with an online back-translation loss. Results are reported\nin Table 2. We compare our approach with the ones of Lample et al. [26]. For each language pair, we\nobserve signiﬁcant improvements over the previous state of the art. We re-implemented the NMT\napproach of Lample et al. [26] (EMB), and obtained better results than reported in their paper. We\nexpect that this is due to our multi-GPU implementation which uses signiﬁcantly larger batches. In\nGerman-English, our best model outperforms the previous unsupervised approach by more than 9.1\nBLEU, and 13.3 BLEU if we only consider neural unsupervised approaches. Compared to pretraining\nonly the lookup table (EMB), pretraining both the encoder and decoder with MLM leads to consistent\nsigniﬁcant improvements of up to 7 BLEU on German-English. We also observe that the MLM\nobjective pretraining consistently outperforms the CLM one, going from 30.4 to 33.4 BLEU on\nEnglish-French, and from 28.0 to 31.8 on Romanian-English. These results are consistent with the\nones of Devlin et al. [14] who observed a better generalization on NLU tasks when training on the\nMLM objective compared to CLM. We also observe that the encoder is the most important element\nto pretrain: when compared to pretraining both the encoder and the decoder, pretraining only the\ndecoder leads to a signiﬁcant drop in performance, while pretraining only the encoder only has a\nsmall impact on the ﬁnal BLEU score.\nSupervised machine translation In Table 3 we report the performance on Romanian-English\nWMT’16 for different supervised training conﬁgurations: mono-directional (ro→en), bidirectional\n(ro↔en, a multi-NMT model trained on both en →ro and ro→en) and bidirectional with back-\ntranslation (ro↔en + BT). Models with back-translation are trained with the same monolingual\ndata as language models used for pretraining. As in the unsupervised setting, we observe that\npretraining provides a signiﬁcant boost in BLEU score for each conﬁguration, and that pretraining\nwith the MLM objective leads to the best performance. Also, while models with back-translation\nhave access to the same amount of monolingual data as the pretrained models, they are not able\nto generalize as well on the evaluation sets. Our bidirectional model trained with back-translation\nobtains the best performance and reaches 38.5 BLEU, outperforming the previous SOTA of Sennrich\net al. [33] (based on back-translation and ensemble models) by more than 4 BLEU. Similar to\nEnglish-Romanian, we obtained a 1.5 BLEU improvement for English-German WMT’16 using MLM\n7\npretraining. For English-French WMT’14 which contains signiﬁcantly more supervised training data,\nwe only obtained a minor improvement of 0.1 BLEU, which tends to indicate that the gains coming\nfrom pretraining are not as important for very high-resource settings than they are for lower-resource\nlanguages. However, in all cases we observed that convergence with pretraining is extremely fast.\nTypically, even for English-French, we observed that the model only needs a few epochs to converge.\nPretraining - CLM MLM\nSennrich et al. 33.9 - -\nro→ en 28.4 31.5 35.3\nro↔ en 28.5 31.5 35.6\nro↔ en + BT 34.4 37.0 38.5\nTable 3: Results on supervised MT. BLEU scores on WMT’16 Romanian-English. The previous\nstate-of-the-art of Sennrich et al. [33] uses both back-translation and an ensemble model. ro↔ en\ncorresponds to models trained on both directions.\nLow-resource language model In Table 4, we investigate the impact of cross-lingual language\nmodeling for improving the perplexity of a Nepali language model. To do so, we train a Nepali\nlanguage model on Wikipedia, together with additional data from either English or Hindi. While\nNepali and English are distant languages, Nepali and Hindi are similar as they share the same\nDevanagari script and have a common Sanskrit ancestor. When using English data, we reduce the\nperplexity on the Nepali language model by 17.1 points, going from 157.2 for Nepali-only language\nmodeling to 140.1 when using English. Using additional data from Hindi, we get a much larger\nperplexity reduction of 41.6. Finally, by leveraging data from both English and Hindi, we reduce\nthe perplexity even more to 109.3 on Nepali. The gains in perplexity from cross-lingual language\nmodeling can be partly explained by the n-grams anchor points that are shared across languages, for\ninstance in Wikipedia articles. The cross-lingual language model can thus transfer the additional\ncontext provided by the Hindi or English monolingual corpora through these anchor points to improve\nthe Nepali language model.\nTraining languages Nepali perplexity\nNepali 157.2\nNepali + English 140.1\nNepali + Hindi 115.6\nNepali + English + Hindi 109.3\nTable 4: Results on language modeling.\nNepali perplexity when using additional data\nfrom a similar language (Hindi) or a distant\nlanguage (English).\nCosine sim. L2 dist. SemEval’17\nMUSE 0.38 5.13 0.65\nConcat 0.36 4.89 0.52\nXLM 0.55 2.64 0.69\nTable 5: Unsupervised cross-lingual word\nembeddings Cosine similarity and L2 dis-\ntance between source words and their trans-\nlations. Pearson correlation on SemEval’17\ncross-lingual word similarity task of Camacho-\nCollados et al. [8].\nUnsupervised cross-lingual word embeddings The MUSE, Concat and XLM (MLM) methods\nprovide unsupervised cross-lingual word embedding spaces that have different properties. In Table 5,\nwe study those three methods using the same word vocabulary and compute the cosine similarity\nand L2 distance between word translation pairs from the MUSE dictionaries. We also evaluate\nthe quality of the cosine similarity measure via the SemEval’17 cross-lingual word similarity task\nof Camacho-Collados et al. [8]. We observe that XLM outperforms both MUSE and Concat on\ncross-lingual word similarity, reaching a Pearson correlation of 0.69. Interestingly, word translation\npairs are also far closer in the XLM cross-lingual word embedding space than for MUSE or Concat.\nSpeciﬁcally, MUSE obtains 0.38 and 5.13 for cosine similarity and L2 distance while XLM gives\n0.55 and 2.64 for the same metrics. Note that XLM embeddings have the particularity of being\ntrained together with a sentence encoder which may enforce this closeness, while MUSE and Concat\nare based on fastText word embeddings.\n8\n6 Conclusion\nIn this work, we show for the ﬁrst time the strong impact of cross-lingual language model (XLM)\npretraining. We investigate two unsupervised training objectives that require only monolingual\ncorpora: Causal Language Modeling (CLM) and Masked Language Modeling (MLM). We show\nthat both the CLM and MLM approaches provide strong cross-lingual features that can be used for\npretraining models. On unsupervised machine translation, we show that MLM pretraining is extremely\neffective. We reach a new state of the art of 34.3 BLEU on WMT’16 German-English, outperforming\nthe previous best approach by more than 9 BLEU. Similarly, we obtain strong improvements on\nsupervised machine translation. We reach a new state of the art on WMT’16 Romanian-English of\n38.5 BLEU, which corresponds to an improvement of more than 4 BLEU points. We also demonstrate\nthat XLMs can be used to improve the perplexity of a Nepali language model, and that it provides\nunsupervised cross-lingual word embeddings. Without using a single parallel sentence, our MLM\nmodel ﬁne-tuned on XNLI already outperforms the previous supervised state of the art by 1.3%\naccuracy on average. Our translation language model objective (TLM) leverages parallel data to\nimprove further the alignment of sentence representations. When used together with MLM, we show\nthat this supervised approach beats the previous state of the art on XNLI by 4.9% accuracy on average.\nOur code and pretrained models are publicly available.\nReferences\n[1] Rami Al-Rfou, Dokook Choe, Noah Constant, Mandy Guo, and Llion Jones. Character-level\nlanguage modeling with deeper self-attention. arXiv preprint arXiv:1808.04444, 2018.\n[2] Waleed Ammar, George Mulcaire, Yulia Tsvetkov, Guillaume Lample, Chris Dyer, and Noah A\nSmith. Massively multilingual word embeddings. arXiv preprint arXiv:1602.01925, 2016.\n[3] Kunchukuttan Anoop, Mehta Pratik, and Bhattacharyya Pushpak. The iit bombay english-hindi\nparallel corpus. In LREC, 2018.\n[4] Mikel Artetxe and Holger Schwenk. Massively multilingual sentence embeddings for zero-shot\ncross-lingual transfer and beyond. arXiv preprint arXiv:1812.10464, 2018.\n[5] Mikel Artetxe, Gorka Labaka, Eneko Agirre, and Kyunghyun Cho. Unsupervised neural\nmachine translation. In International Conference on Learning Representations (ICLR) , 2018.\n[6] Piotr Bojanowski, Edouard Grave, Armand Joulin, and Tomas Mikolov. Enriching word vectors\nwith subword information. Transactions of the Association for Computational Linguistics , 5:\n135–146, 2017.\n[7] Samuel R. Bowman, Gabor Angeli, Christopher Potts, and Christopher D. Manning. A large\nannotated corpus for learning natural language inference. In EMNLP, 2015.\n[8] Jose Camacho-Collados, Mohammad Taher Pilehvar, Nigel Collier, and Roberto Navigli.\nSemeval-2017 task 2: Multilingual and cross-lingual semantic word similarity. In Proceedings\nof the 11th International Workshop on Semantic Evaluation (SemEval-2017) , pages 15–26,\n2017.\n[9] Pi-Chuan Chang, Michel Galley, and Christopher D Manning. Optimizing chinese word\nsegmentation for machine translation performance. In Proceedings of the third workshop on\nstatistical machine translation, pages 224–232, 2008.\n[10] Alexis Conneau and Douwe Kiela. Senteval: An evaluation toolkit for universal sentence\nrepresentations. LREC, 2018.\n[11] Alexis Conneau, Guillaume Lample, Marc’Aurelio Ranzato, Ludovic Denoyer, and Hervé\nJegou. Word translation without parallel data. In ICLR, 2018.\n[12] Alexis Conneau, Ruty Rinott, Guillaume Lample, Adina Williams, Samuel R. Bowman, Holger\nSchwenk, and Veselin Stoyanov. Xnli: Evaluating cross-lingual sentence representations. In\nProceedings of the 2018 Conference on Empirical Methods in Natural Language Processing .\nAssociation for Computational Linguistics, 2018.\n[13] Zihang Dai, Zhilin Yang, Yiming Yang, William W. Cohen, Jaime Carbonell, Quoc V . Le, and\nRuslan Salakhutdinov. Transformer-XL: Language modeling with longer-term dependency,\n2019. URL https://openreview.net/forum?id=HJePno0cYm.\n9\n[14] Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. Bert: Pre-training of\ndeep bidirectional transformers for language understanding. arXiv preprint arXiv:1810.04805,\n2018.\n[15] Akiko Eriguchi, Melvin Johnson, Orhan Firat, Hideto Kazawa, and Wolfgang Macherey. Zero-\nshot cross-lingual classiﬁcation using multilingual neural machine translation. arXiv preprint\narXiv:1809.04686, 2018.\n[16] Manaal Faruqui and Chris Dyer. Improving vector space word representations using multilingual\ncorrelation. Proceedings of EACL, 2014.\n[17] Dan Hendrycks and Kevin Gimpel. Bridging nonlinearities and stochastic regularizers with\ngaussian error linear units. arXiv preprint arXiv:1606.08415, 2016.\n[18] Karl Moritz Hermann and Phil Blunsom. Multilingual models for compositional distributed\nsemantics. arXiv preprint arXiv:1404.4641, 2014.\n[19] Sepp Hochreiter and Jürgen Schmidhuber. Long short-term memory. Neural computation, 9(8):\n1735–1780, 1997.\n[20] Jeremy Howard and Sebastian Ruder. Universal language model ﬁne-tuning for text classi-\nﬁcation. In Proceedings of the 56th Annual Meeting of the Association for Computational\nLinguistics (V olume 1: Long Papers), volume 1, pages 328–339, 2018.\n[21] Melvin Johnson, Mike Schuster, Quoc V Le, Maxim Krikun, Yonghui Wu, Zhifeng Chen, Nikhil\nThorat, Fernanda Viégas, Martin Wattenberg, Greg Corrado, et al. Google’s multilingual neural\nmachine translation system: Enabling zero-shot translation. Transactions of the Association for\nComputational Linguistics, 5:339–351, 2017.\n[22] Rafal Jozefowicz, Oriol Vinyals, Mike Schuster, Noam Shazeer, and Yonghui Wu. Exploring\nthe limits of language modeling. arXiv preprint arXiv:1602.02410, 2016.\n[23] Diederik P Kingma and Jimmy Ba. Adam: A method for stochastic optimization. arXiv preprint\narXiv:1412.6980, 2014.\n[24] Philipp Koehn, Hieu Hoang, Alexandra Birch, Chris Callison-Burch, Marcello Federico, Nicola\nBertoldi, Brooke Cowan, Wade Shen, Christine Moran, Richard Zens, et al. Moses: Open\nsource toolkit for statistical machine translation. In Proceedings of the 45th annual meeting\nof the ACL on interactive poster and demonstration sessions , pages 177–180. Association for\nComputational Linguistics, 2007.\n[25] Guillaume Lample, Alexis Conneau, Ludovic Denoyer, and Marc’Aurelio Ranzato. Unsuper-\nvised machine translation using monolingual corpora only. In ICLR, 2018.\n[26] Guillaume Lample, Myle Ott, Alexis Conneau, Ludovic Denoyer, and Marc’Aurelio Ranzato.\nPhrase-based & neural unsupervised machine translation. In EMNLP, 2018.\n[27] Tomas Mikolov, Quoc V Le, and Ilya Sutskever. Exploiting similarities among languages for\nmachine translation. arXiv preprint arXiv:1309.4168, 2013.\n[28] Tomas Mikolov, Ilya Sutskever, Kai Chen, Greg S Corrado, and Jeff Dean. Distributed repre-\nsentations of words and phrases and their compositionality. In Advances in neural information\nprocessing systems, pages 3111–3119, 2013.\n[29] Adam Paszke, Sam Gross, Soumith Chintala, Gregory Chanan, Edward Yang, Zachary DeVito,\nZeming Lin, Alban Desmaison, Luca Antiga, and Adam Lerer. Automatic differentiation in\npytorch. NIPS 2017 Autodiff Workshop, 2017.\n[30] Alec Radford, Karthik Narasimhan, Tim Salimans, and Ilya Sutskever. Improving language\nunderstanding by generative pre-training. URL https://s3-us-west-2.amazonaws.com/openai-\nassets/research-covers/language-unsupervised/language_understanding_paper .pdf, 2018. URL\nhttps://s3-us-west-2.amazonaws.com/openai-assets/research-covers/language-unsupervised/\nlanguage_understanding_paper.pdf.\n[31] Prajit Ramachandran, Peter J Liu, and Quoc V Le. Unsupervised pretraining for sequence to\nsequence learning. arXiv preprint arXiv:1611.02683, 2016.\n[32] Rico Sennrich, Barry Haddow, and Alexandra Birch. Neural machine translation of rare\nwords with subword units. In Proceedings of the 54th Annual Meeting of the Association for\nComputational Linguistics, pages 1715–1725, 2015.\n10\n[33] Rico Sennrich, Barry Haddow, and Alexandra Birch. Edinburgh neural machine translation\nsystems for wmt 16. arXiv preprint arXiv:1606.02891, 2016.\n[34] Samuel L Smith, David HP Turban, Steven Hamblin, and Nils Y Hammerla. Ofﬂine bilingual\nword vectors, orthogonal transformations and the inverted softmax. International Conference\non Learning Representations, 2017.\n[35] Richard Socher, Alex Perelygin, Jean Wu, Jason Chuang, Christopher D Manning, Andrew Ng,\nand Christopher Potts. Recursive deep models for semantic compositionality over a sentiment\ntreebank. In Proceedings of the 2013 conference on empirical methods in natural language\nprocessing, pages 1631–1642, 2013.\n[36] Wilson L Taylor. “cloze procedure”: A new tool for measuring readability. Journalism Bulletin,\n30(4):415–433, 1953.\n[37] Jörg Tiedemann. Parallel data, tools and interfaces in opus. In Nicoletta Calzolari (Conference\nChair), Khalid Choukri, Thierry Declerck, Mehmet Ugur Dogan, Bente Maegaard, Joseph\nMariani, Jan Odijk, and Stelios Piperidis, editors, LREC, Istanbul, Turkey, may 2012. European\nLanguage Resources Association (ELRA). ISBN 978-2-9517408-7-7.\n[38] Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N. Gomez,\nLukasz Kaiser, and Illia Polosukhin. Attention is all you need. In Advances in Neural Informa-\ntion Processing Systems, pages 6000–6010, 2017.\n[39] Takashi Wada and Tomoharu Iwata. Unsupervised cross-lingual word embedding by multilin-\ngual neural language models. arXiv preprint arXiv:1809.02306, 2018.\n[40] Alex Wang, Amapreet Singh, Julian Michael, Felix Hill, Omer Levy, and Samuel R Bowman.\nGlue: A multi-task benchmark and analysis platform for natural language understanding. arXiv\npreprint arXiv:1804.07461, 2018.\n[41] Paul J Werbos. Backpropagation through time: what it does and how to do it. Proceedings of\nthe IEEE, 78(10):1550–1560, 1990.\n[42] Adina Williams, Nikita Nangia, and Samuel R. Bowman. A broad-coverage challenge corpus\nfor sentence understanding through inference. In NAACL, 2017.\n[43] Chao Xing, Dong Wang, Chao Liu, and Yiye Lin. Normalized word embedding and orthogonal\ntransform for bilingual word translation. Proceedings of NAACL, 2015.\n[44] Michal Ziemski, Marcin Junczys-Dowmunt, and Bruno Pouliquen. The united nations parallel\ncorpus v1. 0. In LREC, 2016.\n11",
  "values": {
    "Collective influence": "No",
    "Critiqability": "No",
    "Not socially biased": "No",
    "User influence": "No",
    "Privacy": "No",
    "Non-maleficence": "No",
    "Explicability": "No",
    "Deferral to humans": "No",
    "Transparent (to users)": "No",
    "Justice": "No",
    "Beneficence": "No",
    "Respect for Law and public interest": "No",
    "Interpretable (to users)": "No",
    "Fairness": "No",
    "Autonomy (power to decide)": "No",
    "Respect for Persons": "No"
  }
}