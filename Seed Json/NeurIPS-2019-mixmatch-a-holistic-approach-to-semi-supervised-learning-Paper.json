{
  "pdf": "NeurIPS-2019-mixmatch-a-holistic-approach-to-semi-supervised-learning-Paper",
  "title": "MixMatch: A Holistic Approach to Semi-Supervised Learning",
  "author": "David Berthelot, Nicholas Carlini, Ian Goodfellow, Nicolas Papernot, Avital Oliver, Colin A. Raffel",
  "paper_id": "NeurIPS-2019-mixmatch-a-holistic-approach-to-semi-supervised-learning-Paper",
  "text": "MixMatch: A Holistic Approach to\nSemi-Supervised Learning\nDavid Berthelot\nGoogle Research\ndberth@google.com\nNicholas Carlini\nGoogle Research\nncarlini@google.com\nIan Goodfellow\nWork done at Google\nian-academic@mailfence.com\nA vital Oliver\nGoogle Research\navitalo@google.com\nNicolas Papernot\nGoogle Research\npapernot@google.com\nColin Raffel\nGoogle Research\ncraffel@google.com\nAbstract\nSemi-supervised learning has proven to be a powerful paradigm for leveraging\nunlabeled data to mitigate the reliance on large labeled datasets. In this work, we\nunify the current dominant approaches for semi-supervised learning to produce a\nnew algorithm, MixMatch, that guesses low-entropy labels for data-augmented un-\nlabeled examples and mixes labeled and unlabeled data using MixUp. MixMatch\nobtains state-of-the-art results by a large margin across many datasets and labeled\ndata amounts. For example, on CIFAR-10 with 250 labels, we reduce error rate by a\nfactor of 4 (from\n38% to 11%) and by a factor of 2 on STL-10. We also demonstrate\nhow MixMatch can help achieve a dramatically better accuracy-privacy trade-off\nfor differential privacy. Finally, we perform an ablation study to tease apart which\ncomponents of MixMatch are most important for its success. We release all code\nused in our experiments. 1\n1 Introduction\nMuch of the recent success in training large, deep neural networks is thanks in part to the existence\nof large labeled datasets. Y et, collecting labeled data is expensive for many learning tasks because\nit necessarily involves expert knowledge. This is perhaps best illustrated by medical tasks where\nmeasurements call for expensive machinery and labels are the fruit of a time-consuming analysis that\ndraws from multiple human experts. Furthermore, data labels may contain private information. In\ncomparison, in many tasks it is much easier or cheaper to obtain unlabeled data.\nSemi-supervised learning [6] (SSL) seeks to largely alleviate the need for labeled data by allowing\na model to leverage unlabeled data. Many recent approaches for semi-supervised learning add a\nloss term which is computed on unlabeled data and encourages the model to generalize better to\nunseen data. In much recent work, this loss term falls into one of three classes (discussed further\nin Section 2): entropy minimization [\n18, 28]—which encourages the model to output conﬁdent\npredictions on unlabeled data; consistency regularization—which encourages the model to produce\nthe same output distribution when its inputs are perturbed; and generic regularization—which\nencourages the model to generalize well and avoid overﬁtting the training data.\nIn this paper, we introduce MixMatch, an SSL algorithm which introduces a single loss that gracefully\nuniﬁes these dominant approaches to semi-supervised learning. Unlike previous methods, MixMatch\ntargets all the properties at once which we ﬁnd leads to the following beneﬁts:\n1https://github.com/google-research/mixmatch\n33rd Conference on Neural Information Processing Systems (NeurIPS 2019), V ancouver, Canada.\nSharpen\n… K augmentations ...\nClassify\nClassify\nUnlabeled\nGuessed Label\nAverage\nFigure 1: Diagram of the label guessing process used in MixMatch. Stochastic data augmentation\nis applied to an unlabeled image K times, and each augmented image is fed through the classiﬁer.\nThen, the average of these K predictions is “sharpened” by adjusting the distribution’s temperature.\nSee algorithm 1 for a full description.\n• Experimentally, we show that MixMatch obtains state-of-the-art results on all standard\nimage benchmarks (section 4.2), and reducing the error rate on CIFAR-10 by a factor of 4;\n• We further show in an ablation study that MixMatch is greater than the sum of its parts;\n• We demonstrate in section 4.3 that MixMatch is useful for differentially private learning,\nenabling students in the PA TE framework [36] to obtain new state-of-the-art results that\nsimultaneously strengthen both privacy guarantees and accuracy.\nIn short, MixMatch introduces a uniﬁed loss term for unlabeled data that seamlessly reduces entropy\nwhile maintaining consistency and remaining compatible with traditional regularization techniques.\n2 Related Work\nTo set the stage for MixMatch, we ﬁrst introduce existing methods for SSL. We focus mainly on\nthose which are currently state-of-the-art and that MixMatch builds on; there is a wide literature on\nSSL techniques that we do not discuss here (e.g., “transductive” models [ 14, 22, 21], graph-based\nmethods [49, 4, 29], generative modeling [3, 27, 41, 9, 17, 23, 38, 34, 42], etc.). More comprehensive\noverviews are provided in [ 49, 6]. In the following, we will refer to a generic model pmodel(y |x; θ)\nwhich produces a distribution over class labels y for an input x with parameters θ.\n2.1 Consistency Regularization\nA common regularization technique in supervised learning is data augmentation, which applies input\ntransformations assumed to leave class semantics unaffected. For example, in image classiﬁcation,\nit is common to elastically deform or add noise to an input image, which can dramatically change\nthe pixel content of an image without altering its label [\n7, 43, 10]. Roughly speaking, this can\nartiﬁcially expand the size of a training set by generating a near-inﬁnite stream of new, modiﬁed data.\nConsistency regularization applies data augmentation to semi-supervised learning by leveraging the\nidea that a classiﬁer should output the same class distribution for an unlabeled example even after it\nhas been augmented. More formally, consistency regularization enforces that an unlabeled example x\nshould be classiﬁed the same as Augment(x), an augmentation of itself.\nIn the simplest case, for unlabeled points x, prior work [25, 40] adds the loss term\n∥pmodel(y |Augment(x); θ) − pmodel(y |Augment(x); θ)∥2\n2. (1)\nNote that Augment(x) is a stochastic transformation, so the two terms in eq. (1) are not identical.\n“Mean Teacher” [ 44] replaces one of the terms in eq. (1) with the output of the model using an\nexponential moving average of model parameter values. This provides a more stable target and was\nfound empirically to signiﬁcantly improve results. A drawback to these approaches is that they use\ndomain-speciﬁc data augmentation strategies. “Virtual Adversarial Training” [ 31] (V A T) addresses\nthis by instead computing an additive perturbation to apply to the input which maximally changes the\noutput class distribution. MixMatch utilizes a form of consistency regularization through the use of\nstandard data augmentation for images (random horizontal ﬂips and crops).\n2.2 Entropy Minimization\nA common underlying assumption in many semi-supervised learning methods is that the classiﬁer’s\ndecision boundary should not pass through high-density regions of the marginal data distribution.\n2\nOne way to enforce this is to require that the classiﬁer output low-entropy predictions on unlabeled\ndata. This is done explicitly in [ 18] with a loss term which minimizes the entropy of pmodel(y |x; θ)\nfor unlabeled data x. This form of entropy minimization was combined with V A T in [31] to obtain\nstronger results. “Pseudo-Label” [ 28] does entropy minimization implicitly by constructing hard\n(1-hot) labels from high-conﬁdence predictions on unlabeled data and using these as training targets\nin a standard cross-entropy loss. MixMatch also implicitly achieves entropy minimization through the\nuse of a “sharpening” function on the target distribution for unlabeled data, described in section 3.2.\n2.3 Traditional Regularization\nRegularization refers to the general approach of imposing a constraint on a model to make it harder to\nmemorize the training data and therefore hopefully make it generalize better to unseen data [ 19]. We\nuse weight decay which penalizes the L2 norm of the model parameters [ 30, 46]. We also use MixUp\n[47] in MixMatch to encourage convex behavior “between” examples. We utilize MixUp as both\nas a regularizer (applied to labeled datapoints) and a semi-supervised learning method (applied to\nunlabeled datapoints). MixUp has been previously applied to semi-supervised learning; in particular,\nthe concurrent work of [ 45] uses a subset of the methodology used in MixMatch. We clarify the\ndifferences in our ablation study (section 4.2.3).\n3 MixMatch\nIn this section, we introduce MixMatch, our proposed semi-supervised learning method. MixMatch\nis a “holistic” approach which incorporates ideas and components from the dominant paradigms for\nSSL discussed in section 2. Given a batch X of labeled examples with one-hot targets (representing\none of L possible labels) and an equally-sized batch U of unlabeled examples, MixMatch produces\na processed batch of augmented labeled examples X ′ and a batch of augmented unlabeled examples\nwith “guessed” labels U ′. U ′ and X ′ are then used in computing separate labeled and unlabeled loss\nterms. More formally, the combined loss L for semi-supervised learning is deﬁned as\nX ′, U ′ = MixMatch(X , U , T, K, α) (2)\nLX = 1\n|X′|\n∑\nx,p∈X ′\nH(p, pmodel(y |x; θ)) (3)\nLU = 1\nL|U′|\n∑\nu,q∈U ′\n∥q − pmodel(y |u; θ)∥2\n2 (4)\nL = LX + λU LU (5)\nwhere H(p, q) is the cross-entropy between distributions p and q, and T , K, α, and λU are hyperpa-\nrameters described below. The full MixMatch algorithm is provided in algorithm 1, and a diagram\nof the label guessing process is shown in ﬁg. 1. Next, we describe each part of MixMatch.\n3.1 Data Augmentation\nAs is typical in many SSL methods, we use data augmentation both on labeled and unlabeled data.\nFor each xb in the batch of labeled data X , we generate a transformed version ˆxb = Augment(xb)\n(algorithm 1, line 3). For each ub in the batch of unlabeled data U , we generate K augmentations\nˆub,k = Augment(ub), k ∈ (1, . . . , K) (algorithm 1, line 5). We use these individual augmentations\nto generate a “guessed label” qb for each ub, through a process we describe in the following subsection.\n3.2 Label Guessing\nFor each unlabeled example in U , MixMatch produces a “guess” for the example’s label using the\nmodel’s predictions. This guess is later used in the unsupervised loss term. To do so, we compute the\naverage of the model’s predicted class distributions across all the K augmentations of ub by\n¯qb = 1\nK\nK∑\nk=1\npmodel(y | ˆub,k; θ) (6)\nin algorithm 1, line 7. Using data augmentation to obtain an artiﬁcial target for an unlabeled example\nis common in consistency regularization methods [25, 40, 44].\n3\nAlgorithm 1 MixMatch takes a batch of labeled data X and a batch of unlabeled data U and produces\na collection X ′ (resp. U ′) of processed labeled examples (resp. unlabeled with guessed labels).\n1: Input: Batch of labeled examples and their one-hot labels X =\n(\n(xb, pb); b ∈ (1, . . . , B)\n)\n, batch of\nunlabeled examples U =\n(\nub; b ∈ (1, . . . , B)\n)\n, sharpening temperature T , number of augmentations K,\nBeta distribution parameter α for MixUp.\n2: for b = 1 to B do\n3: ˆxb = Augment(xb) // Apply data augmentation to xb\n4: for k = 1 to K do\n5: ˆub,k = Augment(ub) // Apply kth round of data augmentation to ub\n6: end for\n7: ¯qb = 1\nK\n∑\nk pmodel(y | ˆub,k; θ) // Compute average predictions across all augmentations of ub\n8: qb = Sharpen(¯qb, T ) // Apply temperature sharpening to the average prediction (see eq. (7))\n9: end for\n10: ˆX =\n(\n(ˆxb, pb); b ∈ (1, . . . , B)\n)\n// Augmented labeled examples and their labels\n11: ˆU =\n(\n(ˆub,k, qb); b ∈ (1, . . . , B), k ∈ (1, . . . , K)\n)\n// Augmented unlabeled examples, guessed labels\n12: W = Shuﬄe\n(\nConcat( ˆX , ˆU )\n)\n// Combine and shufﬂe labeled and unlabeled data\n13: X ′ =\n(\nMixUp( ˆXi, Wi); i ∈ (1, . . . ,| ˆX |)\n)\n// Apply MixUp to labeled data and entries from W\n14: U ′ =\n(\nMixUp( ˆUi, Wi+| ˆX |); i ∈ (1, . . . ,| ˆU |)\n)\n// Apply MixUp to unlabeled data and the rest of W\n15: return X ′, U ′\nSharpening. In generating a label guess, we perform one additional step inspired by the success\nof entropy minimization in semi-supervised learning (discussed in section 2.2). Given the average\nprediction over augmentations ¯qb, we apply a sharpening function to reduce the entropy of the label\ndistribution. In practice, for the sharpening function, we use the common approach of adjusting the\n“temperature” of this categorical distribution [16], which is deﬁned as the operation\nSharpen(p, T )i := p\n1\nT\ni\n/ L∑\nj=1\np\n1\nT\nj (7)\nwhere p is some input categorical distribution (speciﬁcally in MixMatch, p is the average class\nprediction over augmentations ¯qb, as shown in algorithm 1, line 8) and T is a hyperparameter. As\nT → 0, the output of Sharpen(p, T ) will approach a Dirac (“one-hot”) distribution. Since we will\nlater use qb = Sharpen(¯qb, T ) as a target for the model’s prediction for an augmentation of ub,\nlowering the temperature encourages the model to produce lower-entropy predictions.\n3.3 MixUp\nWe use MixUp for semi-supervised learning, and unlike past work for SSL we mix both labeled\nexamples and unlabeled examples with label guesses (generated as described in section 3.2). To be\ncompatible with our separate loss terms, we deﬁne a slightly modiﬁed version of MixUp. For a pair\nof two examples with their corresponding labels probabilities (x1, p1), (x2, p2) we compute (x′, p′)\nby\nλ ∼ Beta(α, α) (8)\nλ′ = max(λ, 1 − λ) (9)\nx′ = λ′x1 + (1 − λ′)x2 (10)\np′ = λ′p1 + (1 − λ′)p2 (11)\nwhere α is a hyperparameter. V anilla MixUp omits eq. (9) (i.e. it sets λ′ = λ). Given that labeled\nand unlabeled examples are concatenated in the same batch, we need to preserve the order of the\nbatch to compute individual loss components appropriately. This is achieved by eq. (9) which ensures\nthat x′ is closer to x1 than to x2. To apply MixUp, we ﬁrst collect all augmented labeled examples\nwith their labels and all unlabeled examples with their guessed labels into\nˆX =\n(\n(ˆxb, pb); b ∈ (1, . . . , B)\n)\n(12)\nˆU =\n(\n(ˆub,k, qb); b ∈ (1, . . . , B), k ∈ (1, . . . , K)\n)\n(13)\n4\n(algorithm 1, lines 10–11). Then, we combine these collections and shufﬂe the result to form W\nwhich will serve as a data source for MixUp (algorithm 1, line 12). For each the ith example-label\npair in ˆX , we compute MixUp( ˆXi, Wi) and add the result to the collection X ′ (algorithm 1, line\n13). We compute U ′\ni = MixUp( ˆUi, Wi+| ˆX |) for i ∈ (1, . . . ,|ˆU |), intentionally using the remainder\nof W that was not used in the construction of X ′ (algorithm 1, line 14). To summarize, MixMatch\ntransforms X into X ′, a collection of labeled examples which have had data augmentation and\nMixUp (potentially mixed with an unlabeled example) applied. Similarly, U is transformed into U ′,\na collection of multiple augmentations of each unlabeled example with corresponding label guesses.\n3.4 Loss Function\nGiven our processed batches X ′ and U ′, we use the standard semi-supervised loss shown in eqs. (3)\nto (5). Equation (5) combines the typical cross-entropy loss between labels and model predictions\nfrom X ′ with the squared L2 loss on predictions and guessed labels from U ′. We use this L2 loss\nin eq. (4) (the multiclass Brier score [ 5]) because, unlike the cross-entropy, it is bounded and less\nsensitive to incorrect predictions. For this reason, it is often used as the unlabeled data loss in SSL\n[25, 44] as well as a measure of predictive uncertainty [ 26]. We do not propagate gradients through\ncomputing the guessed labels, as is standard [25, 44, 31, 35]\n3.5 Hyperparameters\nSince MixMatch combines multiple mechanisms for leveraging unlabeled data, it introduces various\nhyperparameters – speciﬁcally, the sharpening temperature T , number of unlabeled augmentations K,\nα parameter for Beta in MixUp, and the unsupervised loss weight λU . In practice, semi-supervised\nlearning methods with many hyperparameters can be problematic because cross-validation is difﬁcult\nwith small validation sets [ 35, 39, 35]. However, we ﬁnd in practice that most of MixMatch’s\nhyperparameters can be ﬁxed and do not need to be tuned on a per-experiment or per-dataset basis.\nSpeciﬁcally, for all experiments we set T = 0.5 and K = 2. Further, we only change α and λU on a\nper-dataset basis; we found that α = 0.75 and λU = 100 are good starting points for tuning. In all\nexperiments, we linearly ramp up λU to its maximum value over the ﬁrst 16,000 steps of training as\nis common practice [44].\n4 Experiments\nWe test the effectiveness of MixMatch on standard SSL benchmarks (section 4.2). Our ablation study\nteases apart the contribution of each of MixMatch’s components (section 4.2.3). As an additional\napplication, we consider privacy-preserving learning in section 4.3.\n4.1 Implementation details\nUnless otherwise noted, in all experiments we use the “Wide ResNet-28” model from [ 35]. Our\nimplementation of the model and training procedure closely matches that of [ 35] (including using\n5000 examples to select the hyperparameters), except for the following differences: First, instead\nof decaying the learning rate, we evaluate models using an exponential moving average of their\nparameters with a decay rate of 0.999. Second, we apply a weight decay of 0.0004 at each update for\nthe Wide ResNet-28 model. Finally, we checkpoint every 216 training samples and report the median\nerror rate of the last 20 checkpoints. This simpliﬁes the analysis at a potential cost to accuracy by, for\nexample, averaging checkpoints [2] or choosing the checkpoint with the lowest validation error.\n4.2 Semi-Supervised Learning\nFirst, we evaluate the effectiveness of MixMatch on four standard benchmark datasets: CIFAR-10\nand CIFAR-100 [24], SVHN [ 32], and STL-10 [ 8]. Standard practice for evaluating semi-supervised\nlearning on the ﬁrst three datasets is to treat most of the dataset as unlabeled and use a small portion\nas labeled data. STL-10 is a dataset speciﬁcally designed for SSL, with 5,000 labeled images and\n100,000 unlabeled images which are drawn from a slightly different distribution than the labeled data.\n5\n250 500 1000 2000 4000\nNumber of Labeled Datapoints\n0%\n20%\n40%\n60%\nTest Error\n-Model\nMean Teacher\nVAT\nPseudo-Label\nMixUp\nMixMatch\nSupervised\nFigure 2: Error rate comparison of MixMatch\nto baseline methods on CIFAR-10 for a varying\nnumber of labels. Exact numbers are provided\nin table 5 (appendix). “Supervised” refers to\ntraining with all\n50000 training examples and\nno unlabeled data. With 250 labels MixMatch\nreaches an error rate comparable to next-best\nmethod’s performance with 4000 labels.\n250 500 1000 2000 4000\nNumber of Labeled Datapoints\n0%\n10%\n20%\n30%\n40%\nTest Error\n-Model\nMean Teacher\nVAT\nPseudo-Label\nMixUp\nMixMatch\nSupervised\nFigure 3: Error rate comparison of MixMatch to\nbaseline methods on SVHN for a varying num-\nber of labels. Exact numbers are provided in\ntable 6 (appendix). “Supervised” refers to train-\ning with all 73257 training examples and no un-\nlabeled data. With 250 examples MixMatch\nnearly reaches the accuracy of supervised train-\ning for this model.\n4.2.1 Baseline Methods\nAs baselines, we consider the four methods considered in [ 35] (Π-Model [25, 40], Mean Teacher\n[44], Virtual Adversarial Training [ 31], and Pseudo-Label [ 28]) which are described in section 2. We\nalso use MixUp [47] on its own as a baseline. MixUp is designed as a regularizer for supervised\nlearning, so we modify it for SSL by applying it both to augmented labeled examples and augmented\nunlabeled examples with their corresponding predictions. In accordance with standard usage of\nMixUp, we use a cross-entropy loss between the MixUp-generated guess label and the model’s\nprediction. As advocated by [ 35], we reimplemented each of these methods in the same codebase and\napplied them to the same model (described in section 4.1) to ensure a fair comparison. We re-tuned\nthe hyperparameters for each baseline method, which generally resulted in a marginal accuracy\nimprovement compared to those in [35], thereby providing a more competitive experimental setting\nfor testing out MixMatch.\n4.2.2 Results\nCIFAR-10\nFor CIFAR-10, we evaluate the accuracy of each method with a varying number of\nlabeled examples from 250 to 4000 (as is standard practice). The results can be seen in ﬁg. 2. We\nused λU = 75 for CIFAR-10. We created 5 splits for each number of labeled points, each with a\ndifferent random seed. Each model was trained on each split and the error rates were reported by\nthe mean and variance across splits. We ﬁnd that\nMixMatch outperforms all other methods by a\nsigniﬁcant margin, for example reaching an error rate of 6.24% with 4000 labels. For reference,\non the same model, fully supervised training on all 50000 samples achieves an error rate of 4.17%.\nFurthermore, MixMatch obtains an error rate of 11.08% with only 250 labels. For comparison, at\n250 labels the next-best-performing method (V A T [31]) achieves an error rate of 36.03, over 4.5×\nhigher than MixMatch considering that 4.17% is the error limit obtained on our model with fully\nsupervised learning. In addition, at 4000 labels the next-best-performing method (Mean Teacher [ 44])\nobtains an error rate of 10.36%, which suggests that MixMatch can achieve similar performance\nwith only 1/16 as many labels. We believe that the most interesting comparisons are with very few\nlabeled data points since it reveals the method’s sample efﬁciency which is central to SSL.\nCIFAR-10 and CIFAR-100 with a larger model\nSome prior work [ 44, 2] has also considered the\nuse of a larger, 26 million-parameter model. Our base model, as used in [ 35], has only 1.5 million\nparameters which confounds comparison with these results. For a more reasonable comparison to\nthese results, we measure the effect of increasing the width of our base ResNet model and evaluate\nMixMatch’s performance on a 28-layer Wide Resnet model which has 135 ﬁlters per layer, resulting\nin 26 million parameters. We also evaluate MixMatch on this larger model on CIFAR-100 with\n10000 labels, to compare to the corresponding result from [ 2]. The results are shown in table 1.\nIn general, MixMatch matches or outperforms the best results from [ 2], though we note that the\ncomparison still remains problematic due to the fact that the model from [ 44, 2] also uses more\n6\nMethod CIFAR-10 CIFAR-100\nMean Teacher [44] 6.28 -\nSW A [2] 5.00 28 .80\nMixMatch 4 .95 ± 0.08 25 .88 ± 0.30\nTable 1: CIFAR-10 and CIFAR-100 error rate\n(with 4,000 and 10,000 labels respectively) with\nlarger models (26 million parameters).\nMethod 1000 labels 5000 labels\nCutOut [12] - 12.74\nIIC [20] - 11.20\nSWW AE [48] 25.70 -\nCC-GAN2 [11] 22.20 -\nMixMatch 10 .18 ± 1.46 5.59\nTable 2: STL-10 error rate using 1000-label\nsplits or the entire 5000-label training set.\nLabels 250 500 1000 2000 4000 All\nSVHN 3.78 ± 0.26 3 .64 ± 0.46 3 .27 ± 0.31 3 .04 ± 0.13 2 .89 ± 0.06 2 .59\nSVHN+Extra 2.22 ± 0.08 2 .17 ± 0.07 2 .18 ± 0.06 2 .12 ± 0.03 2 .07 ± 0.05 1 .71\nTable 3: Comparison of error rates for SVHN and SVHN+Extra for MixMatch. The last column\n(“All”) contains the fully-supervised performance with all labels in the corresponding training set.\nsophisticated “shake-shake” regularization [ 15]. For this model, we used a weight decay of 0.0008.\nWe used λU = 75 for CIFAR-10 and λU = 150 for CIFAR-100.\nSVHN and SVHN+Extra As with CIFAR-10, we evaluate the performance of each SSL method\non SVHN with a varying number of labels from 250 to 4000. As is standard practice, we ﬁrst\nconsider the setting where the 73257-example training set is split into labeled and unlabeled data.\nThe results are shown in ﬁg. 3. We used λU = 250 . Here again the models were evaluated on 5\nsplits for each number of labeled points, each with a different random seed. We found MixMatch’s\nperformance to be relatively constant (and better than all other methods) across all amounts of labeled\ndata. Surprisingly, after additional tuning we were able to obtain extremely good performance from\nMean Teacher [44], though its error rate was consistently slightly higher than MixMatch’s.\nNote that SVHN has two training sets: train and extra. In fully-supervised learning, both sets are\nconcatenated to form the full training set ( 604388 samples). In SSL, for historical reasons the extra set\nwas left aside and only train was used ( 73257 samples). We argue that leveraging both train and extra\nfor the unlabeled data is more interesting since it exhibits a higher ratio of unlabeled samples over\nlabeled ones. We report error rates for both SVHN and SVHN+Extra in table 3. For SVHN+Extra\nwe used α = 0 .25, λU = 250 and a lower weight decay of 0.000002 due to the larger amount of\navailable data. We found that on both training sets, MixMatch nearly matches the fully-supervised\nperformance on the same training set almost immediately – for example, MixMatch achieves an error\nrate of 2.22% with only 250 labels on SVHN+Extra compared to the fully-supervised performance of\n1.71%. Interestingly, on SVHN+Extra MixMatch outperformed fully supervised training on SVHN\nwithout extra (2.59% error) for every labeled data amount considered. To emphasize the importance\nof this, consider the following scenario: Y ou have 73257 examples from SVHN with 250 examples\nlabeled and are given a choice: Y ou can either obtain 8× more unlabeled data and use MixMatch or\nobtain 293× more labeled data and use fully-supervised learning. Our results suggest that obtaining\nadditional unlabeled data and using MixMatch is more effective, which conveniently is likely much\ncheaper than obtaining 293× more labels.\nSTL-10 STL-10 contains 5000 training examples aimed at being used with 10 predeﬁned folds (we\nuse the ﬁrst 5 only) with 1000 examples each. However, some prior work trains on all 5000 examples.\nWe thus compare in both experimental settings. With 1000 examples MixMatch surpasses both the\nstate-of-the-art for 1000 examples as well as the state-of-the-art using all 5000 labeled examples.\nNote that none of the baselines in table 2 use the same experimental setup (i.e. model), so it is difﬁcult\nto directly compare the results; however, because MixMatch obtains the lowest error by a factor of\ntwo, we take this to be a vote in conﬁdence of our method. We used λU = 50.\n4.2.3 Ablation Study\nSince MixMatch combines various semi-supervised learning mechanisms, it has a good deal in\ncommon with existing methods in the literature. As a result, we study the effect of removing or\n7\nAblation 250 labels 4000 labels\nMixMatch 11.80 6 .00\nMixMatch without distribution averaging (K = 1) 17.09 8 .06\nMixMatch with K = 3 11.55 6 .23\nMixMatch with K = 4 12.45 5 .88\nMixMatch without temperature sharpening ( T = 1) 27.83 10 .59\nMixMatch with parameter EMA 11.86 6 .47\nMixMatch without MixUp 39 .11 10 .97\nMixMatch with MixUp on labeled only 32.16 9 .22\nMixMatch with MixUp on unlabeled only 12.35 6 .83\nMixMatch with MixUp on separate labeled and unlabeled 12.26 6 .50\nInterpolation Consistency Training [45] 38.60 6 .81\nTable 4: Ablation study results. All values are error rates on CIFAR-10 with 250 or 4000 labels.\nadding components in order to provide additional insight into what makes MixMatch performant.\nSpeciﬁcally, we measure the effect of\n• using the mean class distribution over K augmentations or using the class distribution for a\nsingle augmentation (i.e. setting K = 1)\n• removing temperature sharpening (i.e. setting T = 1)\n• using an exponential moving average (EMA) of model parameters when producing guessed\nlabels, as is done by Mean Teacher [44]\n• performing MixUp between labeled examples only, unlabeled examples only, and without\nmixing across labeled and unlabeled examples\n• using Interpolation Consistency Training [ 45], which can be seen as a special case of this\nablation study where only unlabeled mixup is used, no sharpening is applied and EMA\nparameters are used for label guessing.\nWe carried out the ablation on CIFAR-10 with 250 and 4000 labels; the results are shown in table 4.\nWe ﬁnd that each component contributes to MixMatch’s performance, with the most dramatic\ndifferences in the 250-label setting. Despite Mean Teacher’s effectiveness on SVHN (ﬁg. 3), we\nfound that using a similar EMA of parameter values hurt MixMatch’s performance slightly.\n4.3 Privacy-Preserving Learning and Generalization\nLearning with privacy allows us to measure our approach’s ability to generalize. Indeed, protecting\nthe privacy of training data amounts to proving that the model does not overﬁt: a learning algorithm\nis said to be differentially private (the most widely accepted technical deﬁnition of privacy) if adding,\nmodifying, or removing any of its training samples is guaranteed not to result in a statistically\nsigniﬁcant difference in the model parameters learned [ 13]. For this reason, learning with differential\nprivacy is, in practice, a form of regularization [ 33]. Each training data access constitutes a potential\nprivacy leakage, encoded as the pair of the input and its label. Hence, approaches for deep learning\nfrom private training data, such as DP-SGD [ 1] and PA TE [36], beneﬁt from accessing as few labeled\nprivate training points as possible when computing updates to the model parameters. Semi-supervised\nlearning is a natural ﬁt for this setting.\nWe use the PA TE framework for learning with privacy. A student is trained in a semi-supervised way\nfrom public unlabeled data, part of which is labeled by an ensemble of teachers with access to private\nlabeled training data. The fewer labels a student requires to reach a ﬁxed accuracy, the stronger is the\nprivacy guarantee it provides. Teachers use a noisy voting mechanism to respond to label queries\nfrom the student, and they may choose not to provide a label when they cannot reach a sufﬁciently\nstrong consensus. For this reason, if MixMatch improves the performance of PA TE, it would also\nillustrate MixMatch’s improved generalization from few canonical exemplars of each class.\nWe compare the accuracy-privacy trade-off achieved by MixMatch to a V A T [31] baseline on SVHN.\nV A T achieved the previous state-of-the-art of91.6% test accuracy for a privacy loss of ε = 4.96 [37].\nBecause MixMatch performs well with few labeled points, it is able to achieve 95.21 ± 0.17% test\n8\naccuracy for a much smaller privacy loss of ε = 0.97. Because eε is used to measure the degree of\nprivacy, the improvement is approximately e4 ≈ 55× , a signiﬁcant improvement. A privacy loss ε\nbelow 1 corresponds to a much stronger privacy guarantee. Note that in the private training setting\nthe student model only uses 10,000 total examples.\n5 Conclusion\nWe introduced MixMatch, a semi-supervised learning method which combines ideas and components\nfrom the current dominant paradigms for SSL. Through extensive experiments on semi-supervised and\nprivacy-preserving learning, we found that MixMatch exhibited signiﬁcantly improved performance\ncompared to other methods in all settings we studied, often by a factor of two or more reduction in\nerror rate. In future work, we are interested in incorporating additional ideas from the semi-supervised\nlearning literature into hybrid methods and continuing to explore which components result in effective\nalgorithms. Separately, most modern work on semi-supervised learning algorithms is evaluated on\nimage benchmarks; we are interested in exploring the effectiveness of MixMatch in other domains.\nAcknowledgement\nWe would like to thank Balaji Lakshminarayanan for his helpful theoretical insights.\nReferences\n[1] Martin Abadi, Andy Chu, Ian Goodfellow, H. Brendan McMahan, Ilya Mironov, Kunal Talwar,\nand Li Zhang. Deep learning with differential privacy. In Proceedings of the 2016 ACM SIGSAC\nConference on Computer and Communications Security , pages 308–318. ACM, 2016.\n[2] Ben Athiwaratkun, Marc Finzi, Pavel Izmailov, and Andrew Gordon Wilson. Improv-\ning consistency-based semi-supervised learning with weight averaging. arXiv preprint\narXiv:1806.05594, 2018.\n[3] Mikhail Belkin and Partha Niyogi. Laplacian eigenmaps and spectral techniques for embedding\nand clustering. In Advances in Neural Information Processing Systems , 2002.\n[4] Y oshua Bengio, Olivier Delalleau, and Nicolas Le Roux. Label Propagation and Quadratic\nCriterion, chapter 11. MIT Press, 2006.\n[5] Glenn W. Brier. V eriﬁcation of forecasts expressed in terms of probability. Monthey Weather\nReview, 78(1):1–3, 1950.\n[6] Olivier Chapelle, Bernhard Scholkopf, and Alexander Zien. Semi-Supervised Learning. MIT\nPress, 2006.\n[7] Dan Claudiu Cire¸ san, Ueli Meier, Luca Maria Gambardella, and Jürgen Schmidhuber. Deep, big,\nsimple neural nets for handwritten digit recognition. Neural computation, 22(12):3207–3220,\n2010.\n[8] Adam Coates, Andrew Ng, and Honglak Lee. An analysis of single-layer networks in unsuper-\nvised feature learning. In Proceedings of the fourteenth international conference on artiﬁcial\nintelligence and statistics, pages 215–223, 2011.\n[9] Adam Coates and Andrew Y . Ng. The importance of encoding versus training with sparse\ncoding and vector quantization. In International Conference on Machine Learning , 2011.\n[10] Ekin D. Cubuk, Barret Zoph, Dandelion Mane, Vijay V asudevan, and Quoc V . Le. Autoaugment:\nLearning augmentation policies from data. arXiv preprint arXiv:1805.09501, 2018.\n[11] Emily Denton, Sam Gross, and Rob Fergus. Semi-supervised learning with context-conditional\ngenerative adversarial networks. arXiv preprint arXiv:1611.06430, 2016.\n[12] Terrance DeVries and Graham W. Taylor. Improved regularization of convolutional neural\nnetworks with cutout. arXiv preprint arXiv:1708.04552, 2017.\n9\n[13] Cynthia Dwork, Frank McSherry, Kobbi Nissim, and Adam Smith. Calibrating noise to\nsensitivity in private data analysis. Journal of Privacy and Conﬁdentiality , 7(3):17–51, 2016.\n[14] Alexander Gammerman, V olodya V ovk, and Vladimir V apnik. Learning by transduction. In\nProceedings of the F ourteenth Conference on Uncertainty in Artiﬁcial Intelligence, 1998.\n[15] Xavier Gastaldi. Shake-shake regularization. Fifth International Conference on Learning\nRepresentations (Workshop Track), 2017.\n[16] Ian Goodfellow, Y oshua Bengio, and Aaron Courville. Deep Learning. MIT Press, 2016.\n[17] Ian J. Goodfellow, Aaron Courville, and Y oshua Bengio. Spike-and-slab sparse coding for\nunsupervised feature discovery. In NIPS Workshop on Challenges in Learning Hierarchical\nModels, 2011.\n[18] Yves Grandvalet and Y oshua Bengio. Semi-supervised learning by entropy minimization. In\nAdvances in Neural Information Processing Systems , 2005.\n[19] Geoffrey Hinton and Drew van Camp. Keeping neural networks simple by minimizing the\ndescription length of the weights. In Proceedings of the 6th Annual ACM Conference on\nComputational Learning Theory, 1993.\n[20] Xu Ji, Joao F Henriques, and Andrea V edaldi. Invariant information distillation for unsupervised\nimage segmentation and clustering. arXiv preprint arXiv:1807.06653, 2018.\n[21] Thorsten Joachims. Transductive inference for text classiﬁcation using support vector machines.\nIn International Conference on Machine Learning , 1999.\n[22] Thorsten Joachims. Transductive learning via spectral graph partitioning. In International\nConference on Machine Learning, 2003.\n[23] Diederik P . Kingma, Shakir Mohamed, Danilo Jimenez Rezende, and Max Welling. Semi-\nsupervised learning with deep generative models. In Advances in Neural Information Processing\nSystems, 2014.\n[24] Alex Krizhevsky. Learning multiple layers of features from tiny images. Technical report,\nUniversity of Toronto, 2009.\n[25] Samuli Laine and Timo Aila. Temporal ensembling for semi-supervised learning. In Fifth\nInternational Conference on Learning Representations , 2017.\n[26] Balaji Lakshminarayanan, Alexander Pritzel, and Charles Blundell. Simple and scalable\npredictive uncertainty estimation using deep ensembles. In Advances in Neural Information\nProcessing Systems, 2017.\n[27] Julia A. Lasserre, Christopher M. Bishop, and Thomas P . Minka. Principled hybrids of generative\nand discriminative models. In IEEE Computer Society Conference on Computer Vision and\nPattern Recognition, 2006.\n[28] Dong-Hyun Lee. Pseudo-label: The simple and efﬁcient semi-supervised learning method for\ndeep neural networks. In ICML Workshop on Challenges in Representation Learning , 2013.\n[29] Bin Liu, Zhirong Wu, Han Hu, and Stephen Lin. Deep metric transfer for label propagation\nwith limited annotated data. arXiv preprint arXiv:1812.08781, 2018.\n[30] Ilya Loshchilov and Frank Hutter. Fixing weight decay regularization in Adam. arXiv preprint\narXiv:1711.05101, 2017.\n[31] Takeru Miyato, Shin-ichi Maeda, Shin Ishii, and Masanori Koyama. Virtual adversarial training:\na regularization method for supervised and semi-supervised learning. IEEE transactions on\npattern analysis and machine intelligence , 2018.\n[32] Y uval Netzer, Tao Wang, Adam Coates, Alessandro Bissacco, Bo Wu, and Andrew Y . Ng.\nReading digits in natural images with unsupervised feature learning. In NIPS Workshop on\nDeep Learning and Unsupervised Feature Learning , 2011.\n10\n[33] Kobbi Nissim and Uri Stemmer. On the generalization properties of differential privacy. CoRR,\nabs/1504.05800, 2015.\n[34] Augustus Odena. Semi-supervised learning with generative adversarial networks. arXiv preprint\narXiv:1606.01583, 2016.\n[35] Avital Oliver, Augustus Odena, Colin Raffel, Ekin Dogus Cubuk, and Ian Goodfellow. Realistic\nevaluation of deep semi-supervised learning algorithms. In Advances in Neural Information\nProcessing Systems, pages 3235–3246, 2018.\n[36] Nicolas Papernot, Martín Abadi, Ulfar Erlingsson, Ian Goodfellow, and Kunal Talwar. Semi-\nsupervised knowledge transfer for deep learning from private training data. arXiv preprint\narXiv:1610.05755, 2016.\n[37] Nicolas Papernot, Shuang Song, Ilya Mironov, Ananth Raghunathan, Kunal Talwar, and Úlfar\nErlingsson. Scalable private learning with pate. arXiv preprint arXiv:1802.08908, 2018.\n[38] Y unchen Pu, Zhe Gan, Ricardo Henao, Xin Y uan, Chunyuan Li, Andrew Stevens, and Lawrence\nCarin. V ariational autoencoder for deep learning of images, labels and captions. In Advances in\nNeural Information Processing Systems, 2016.\n[39] Antti Rasmus, Mathias Berglund, Mikko Honkala, Harri V alpola, and Tapani Raiko. Semi-\nsupervised learning with ladder networks. In Advances in Neural Information Processing\nSystems, 2015.\n[40] Mehdi Sajjadi, Mehran Javanmardi, and Tolga Tasdizen. Regularization with stochastic transfor-\nmations and perturbations for deep semi-supervised learning. In Advances in Neural Information\nProcessing Systems, 2016.\n[41] Ruslan Salakhutdinov and Geoffrey E. Hinton. Using deep belief nets to learn covariance\nkernels for Gaussian processes. In Advances in Neural Information Processing Systems , 2007.\n[42] Tim Salimans, Ian Goodfellow, Wojciech Zaremba, Vicki Cheung, Alec Radford, and Xi Chen.\nImproved techniques for training GANs. In Advances in Neural Information Processing Systems,\n2016.\n[43] Patrice Y . Simard, David Steinkraus, and John C. Platt. Best practice for convolutional neural\nnetworks applied to visual document analysis. In Proceedings of the International Conference\non Document Analysis and Recognition , 2003.\n[44] Antti Tarvainen and Harri V alpola. Mean teachers are better role models: Weight-averaged con-\nsistency targets improve semi-supervised deep learning results. Advances in Neural Information\nProcessing Systems, 2017.\n[45] Vikas V erma, Alex Lamb, Juho Kannala, Y oshua Bengio, and David Lopez-Paz. Interpolation\nconsistency training for semi-supervised learning. arXiv preprint arXiv:1903.03825, 2019.\n[46] Guodong Zhang, Chaoqi Wang, Bowen Xu, and Roger Grosse. Three mechanisms of weight\ndecay regularization. arXiv preprint arXiv:1810.12281, 2018.\n[47] Hongyi Zhang, Moustapha Cisse, Y ann N. Dauphin, and David Lopez-Paz. mixup: Beyond\nempirical risk minimization. arXiv preprint arXiv:1710.09412, 2017.\n[48] Junbo Zhao, Michael Mathieu, Ross Goroshin, and Y ann Lecun. Stacked what-where auto-\nencoders. arXiv preprint arXiv:1506.02351, 2015.\n[49] Xiaojin Zhu, Zoubin Ghahramani, and John D Lafferty. Semi-supervised learning using gaussian\nﬁelds and harmonic functions. In International Conference on Machine Learning , 2003.\n11",
  "values": {
    "Privacy": "No",
    "Deferral to humans": "No",
    "Explicability": "No",
    "Critiqability": "No",
    "Non-maleficence": "No",
    "Beneficence": "No",
    "Collective influence": "No",
    "User influence": "No",
    "Transparent (to users)": "No",
    "Justice": "No",
    "Not socially biased": "No",
    "Respect for Law and public interest": "No",
    "Fairness": "No",
    "Respect for Persons": "No",
    "Interpretable (to users)": "No",
    "Autonomy (power to decide)": "No"
  }
}